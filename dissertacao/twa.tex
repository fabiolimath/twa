
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Modelagem TWA
%% Copyright 2009 Fabio de Oliveira Lima.
%% Este documento é distribuído nos termos da licença 
%% GNU General Public License v2.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{TWA - Modelo para o Projeto Completo de uma WRON }
\label{Basic}

Neste capítulo será apresentada a forma básica do modelo TWA (\textit{Traffic over Wavelength Assignment}), começando pela notação designada aos nós e as
constantes que definem uma instância de
problema para o modelo. Em seguida serão definidas as variáveis utilizadas para compor as restrições e a função objetivo do modelo, passando-se
então à sua descrição. A função objetivo adotada na formulação básica é a minimização dos custos de instalação e operação da rede, valendo-se da capacidade do
modelo escolher também a topologia física da rede. Além disso, foi
considerada a restrição de conservação dos comprimentos de onda ao longo do caminho óptico \cite{Zang00}, ou seja, não se admite a conversão de comprimentos de
onda na camada óptica da rede nesta formulação básica. Outros casos de uso e extenções ao modelo básico serão apresentados no Capítulo \ref{cases}.

\section{Notação e Dados de Entrada}

\begin{notation}
Para uma rede de $N$ nós, os pares ordenados $(m,n)$, $(s,d)$ e $(i,j)$ indicam respectivamente ligações físicas, demandas de tráfego e ligações lógicas,
com $m\neq n$, $s\neq d$ e $i\neq j$, onde $m,n,s,d,i,j\in \{1,..,N\}$. O índice $w \in \{1,..,W\}$ representa comprimentos de onda, onde $W$ é a quantidade
limite de comprimentos de onda que podem ser usados. O índice $v\in \{1,..,N\}$ representa os nós da rede.
\end{notation}

\begin{figure}[htb]
\centering
\includegraphics[bb=43 653 523 825,scale=.9]{figs/indices.eps}
\caption{Representação gráfica da notação associada aos nós da rede.}
\label{fig:Indices}
\end{figure}

A Figura \ref{fig:Indices} ilustra os diferentes escopos dos índices associados aos nós da rede, com relação às ligações físicas $(m,n)$, ligações lógicas
$(i,j)$ e demandas de tráfego $(s,d)$. Esta notação segue a convenção comumente utilizada em trabalhos anteriores \cite{mukherjee,ram02}. É
importante dizer que esta modelagem suporta múltiplas ligações físicas e lógicas entre cada par de nós, portanto, os pares $(m,n)$ e $(i,j)$ representam
conjuntos de possíveis ligações físicas e lógicas, respectivamente. Esses conjuntos não serão explicitamente controlados, sendo esse um dos motivos
da simplicidade do modelo.

\begin{dados}
\label{Cons}
Uma instância para o modelo TWA é definida por:

\begin{enumerate}
\item $N$ $=$ Número de nós da rede.
\item $W$ $=$ Máximo de comprimentos de onda em ligação física.
% \item $H$ $=$ Grau físico máximo de entrada e saída de cada nó.
\item $K$ $=$ Máxima multiplicidade de ligações físicas entre cada par $(m,n)$.
\item $Cap$ $=$ Capacidade de tráfego de cada ligação lógica.
\item $C_{mn}$ $=$ Custo de uma ligação física entre o par $(m,n)$.
\item $T$ $=$ Custo por unidade de fluxo.
\item $P_{sd}$ $=$ Demanda de tráfego, com origem $s$ e destino $d$.
\item $A_s = \sum_d P_{sd} =$ Tráfego agregado pela origem $s$. 
\item $Q_{sd}=P_{sd}/A_s =$ Fração de $A_s$ correspondente à Demanda de tráfego $P_{sd}$.
\end{enumerate}
\end{dados}

% \clearpage

 \section{Componentes Topológicos}
% \label{Top}

A variável central do modelo, a partir da qual todas as demais serão definidas, chamada de componente topológica, é representada graficamente na Figura
\ref{fig:B} e formalmente definida na Variável \ref{comp}. Ela sozinha representa as topologias lógica e física, as rotas físicas das 
ligações lógicas e os comprimentos de onda utilizados.

\begin{var}
\label{comp}
 Seja $B_{iw}^{mn} = k\in \{0,..,K\}$, com $i\neq n$, um componente do conjunto das ligações lógicas com origem $i$ e comprimento de onda $w$,
que utilizam $k$ ligações físicas entre os nós $m$ e $n$.
\end{var}

\begin{figure}[hbt]
 \centering
\includegraphics[bb=177 683 405 753, scale=0.9]{figs/B.eps}
% B.eps: 1179666x1179666 pixel, 300dpi, 9987.84x9987.84 cm, bb=36 739 246 805
 \caption{Representação gráfica de um componente topológico.}
 \label{fig:B}
\end{figure}

% \begin{equation}
% s\neq j\quad \text{ e }\quad i\neq j\quad \forall (s,i,j).
% \label{Nules}
% \end{equation}

%A princípio, o número de variáveis do tipo descrito aqui seria $N^3\cdot W$, mas devemos excluir algumas que são 
% trivialmente nulas: $s\neq j$ pois $s$ é origem da ligação lógica e $j$ é destino da ligação física; e $i\neq j$ pois não são 
% aceitos \textit{autoloops} \cite{cormen02}.

Em um componente topológico $B_{iw}^{mn} = k$, o índice $i$ representa o nó de origem das $k$ ligações lógicas 
que, passando pelas ligações físicas iniciadas em $m$ e incidentes em $n$, usa o comprimento de onda $w$. Conforme a terminologia utilizada
neste trabalho daqui por diante, \textit{um componente topológico $B_{iw}^{mn} = k$ é iniciado em $m$, incidente em $n$, com origem $i$,
comprimento de onda $w$ e valor $k$}.

Considerando que $B_{iw}^{mn}=k$ para algum $k \in \{0,..,K\}$, existem $k$ ligações lógicas originadas em $i$ no comprimento de onda $w$, passando
por $k$ ligações físicas distintas entre o par de nós $(m,n)$. Neste caso, se $k>1$ então há multiplicidade de ligações físicas entre o par de nós $(m,n)$,
pois haveria interferência se houvessem duas ligações lógicas se propagando na mesma ligação física, com o mesmo comprimento de onda. Note
que $K$ limita apenas a multiplicidade das ligações físicas, pois se $K=1$, $B_{iw}^{mn}$ se torna uma variável binária, ainda podem haver múltiplas
ligações lógicas entre um par $(i,j)$, utlizando rotas físicas distintas, ou ainda, comprimentos de onda diferentes em uma mesma
rota física. Se $B_{iw}^{mn}=0$, para um dada par $(m,n)$ e $\Forall{(i,w)}$, então nenhuma ligação física entre o par de nós $(m,n)$ é utilizada.

 Na Figura \ref{fig:Tops}, temos um exemplo de interpretação dos componentes topológicos, todos com origem no nó $i$ e com o 
mesmo comprimento de onda $w_1$. No item $d)$ desta figura, o valor $2$ do componente que liga os nós $(i,m)$ é interpretado 
como duas ligações físicas entre esses nós, representadas no item $a)$. No item $b)$, vemos uma ligação lógica dupla entre os 
nós $(i,n)$, onde uma delas passa de forma transparente pelo nó $m$, como indicado no item $c)$. Note ainda que, no item 
$d)$, há dois caminhos lógicos incidentes em $m$ mas apenas um iniciando. Isso indica que uma ligação lógica termina em $m$, 
enquanto a outra segue adiante.

% \clearpage
\begin{figure}[hbt]
 \centering
\includegraphics[width=0.8\textwidth]{figs/topologias-twa.eps}
% \includegraphics[bb=39 455 511 811, scale=0.4]{figs/topologias.eps}
 % topologias.eps: 1179666x1179666 pixel, 300dpi, 9987.84x9987.84 cm, bb=30 375 511 801
 \caption{Exemplo da interpretação dos componentes topológicos.}
 \label{fig:Tops}
\end{figure}
% \clearpage

A indexação atribuída às variáveis $B_{iw}^{mn}$ especificam apenas o nó $i$, que é onde se iniciam as ligações lógicas representadas, sem deixar claro
aonde elas terminam. Isto significa que estas variáveis agregam todas as ligações lógicas originadas em $i$ que utilizam as ligações físicas entre o par
$(m,n)$ e o comprimento de onda $w$, independente do nó $j$ em que terminam estas ligações lógicas. Esta técnica consiste em uma abordagem bastante
conhecida para a representação de variáveis em problemas de distribuição de fluxo em redes. Em \cite{Tornatore07}, este conceito de agregação de tráfego é
aplicado como meio de simplificação do modelo, reduzindo substancialmente o número de variáveis dos problemas resultantes. No TWA, esta agregação cumpre o
mesmo papel de simplificação, cabendo às restrições do modelo garantir implicitamente a terminação correta destas ligações lógicas agregadas nas variáveis
$B_{iw}^{mn}$.

% A multiplicidade das ligações lógicas pode ser controlada por uma restrição própria, que será mostrada na Seção 
% \ref{ControlMl}.

%  Na versão mais enxuta, com a topologia física fixada (veja a Seção \ref{Fis}, adiante) do modelo é adicionada apenas a 
% variável de distribuição de fluxo agregado. Dependendo do caso de uso, outras variáveis podem ser necessárias (como será 
% visto na Seção \ref{cases}), mas nenhuma supera o número de componentes topológicos, que define portanto a 
% ordem de grandeza do número de variáveis desta modelagem.

\section{Topologia Física e Fração de Fluxo}

Apesar da topologia física ser determinada pelos componentes topológicos, para fins de controle do custo de instalação da rede física,
são necessárias novas incógnitas. Para este fim, é definida a Variável \ref{FisVar}, que registrará em $D_{mn}$ a multiplicidade física determinada pelos
componentes topológicos. Se $D_{mn}=0$, não há ligações físicas entre o par $(m,n)$, mas se $D_{mn}=k$, para algum $k \in \{0,..,K\}$, existem $k$ ligações
físicas entre o par $(m,n)$.

Para resolver o sub-problema de roteamento de tráfego, são definidas as variáveis de fração de fluxo agregado (Variável \ref{FlowVar}). Elas são
semelhantes às variáveis de fluxo agregado utilizadas em \cite{ram96}, todavia há duas diferenças. Uma delas é que aqui essas variáveis são normalizadas em
função do tráfego agregado no origem $A_s$, e são portanto uma fração deste. Essa modificação não é requerida pela modelagem, tendo apenas a função de
facilitar a compreeção das restrições do modelo, que ficam indepemdentes do dados de entrada. 

A outra diferença é que o fluxo é separado por coprimento de onda, como se fossem $W$ redes sem multiplexação sobrepostas. Isso facilita a interpretação das
restrições do modelo, e também ajuda a mantê-lo mais simples. De fato, o controle da distribuição de fluxo deve ser feito em cada ligação lógica
\cite{ram02}, mas a restrição de continuidade de comprimentos de onda exige uma equação para cada $w$ separadamente \cite{Zang00}. Soma-se a isso o fato de
que nesta modelagem múltiplas ligações lógicas são agregadas em cada par $(i,j)$, para todos os valores $w$ utilizados. Assim, separando o tráfego por
comprimento de onda, foi possível combinar o controle da distribuição de tráfego com a restrição de continuidade de comprimentos de onda. Isso será tratado
com mais detalhes na Seção \ref{cap:twa-sec:Bconserv_Cap}.

\begin{var}
 \label{FlowVar}
 Seja $q_{sw}^{ij} \in [0,1]$ a fração de fluxo originado em $s$, passando pelas ligações lógicas entre o par $(i,j)$, no comprimento de onda $w$,
com $s\neq j$. 
\end{var}


 \section{Custo de instalação e Operação}
 \label{cap:twa-sec:funcaoobjetivo}


Duas métricas importantes no projeto da redes ópticas são os custos de instalação e operação \cite{mukherjee}. 
O custo de instalação $C_{mn}$ é o custo associado a uma ligação física entre o par de nós $(m,n)$. O custo total de instalação é dado na equação
\ref{eq:custoInstlacao}. O custo de operação $T$, definido como o custo por unidade de fluxo, é calculado na equação \ref{eq:CustoDeOperacao}, e
influencia também no dimensionamento dos nós da rede.

\begin{equation}
   CI = \sum_{mn} C_{mn}\cdot D_{mn}
   \label{eq:custoInstlacao}
\end{equation}


\begin{equation}
    T = \sum_{sijw} T\cdot q_{sw}^{ij}\cdot A_s
    \label{eq:CustoDeOperacao}
\end{equation}

O custo de operação pode ser dividido em duas partes: uma constante, formada pelas demandas de tráfego (equação \ref{eq:Tc}), que necessariamente
deverão ser roteadas; e outra variável, composta pelo tráfego adicional que é gerado, ou seja, o tráfego 
retransmitido (equação \ref{eq:Tv}). A parte constante do custo de operação não influenciaria na função objetivo, por isso não será incluida em seu cáculo,
dado na equação \ref{eq:FO}.

\begin{equation}
     Tc = \sum_{sd} T\cdot P_{sd}
   \label{eq:Tc}
\end{equation}

\begin{equation}
     Tv = \sum_{sijw} T\cdot q_{sw}^{ij}\cdot A_s\,,\quad \mbox{\small$i\neq s$}
   \label{eq:Tv}
\end{equation}

\begin{equation}
   FO = CI + Tc
   \label{eq:FO}
\end{equation}

Outro ponto positivo dessas métricas é que minimizar o custo por unidade de fluxo é equivalente a minimizar o tráfego retransmitido na rede, o que por 
sua vez, equivale a minimizar o processamento eletrônico de tráfego dos nós da rede \cite{Renato06}. Além disso, será necessária nesta modelagem uma
restrição de limitação da capacidade das ligações lógicas ($Cap$), que equivale à limitar o congestionamento na rede. Assim, limitando a capacidade e
minimizando o custo de operação, temos uma abordagem eficiente, quanto ao custo 
computacional, para controlar também o congestionamento e o processamento, importantes métricas no projeto da topologia virtual \cite{Renato06,ram02}. 

Se não for necessário ponderar o custo por unidade de fluxo, basta fazer $T=1$, e se não for necessário considerar o custo 
total de instalação ($CI$), basta fazer $C_{mn}=0$ para todo $(m,n)$. Deste modo seria 
simplesmente um modelo de minimização do processamento, com limitação do congestionamento \cite{Renato06}. 


 \section{O Modelo TWA}
 
 Nesta seção é apresentada a forma básica do modelo TWA. Suas restrição são apresentadas a seguir, após a função objetivo apresentada na seção anterior.

\textbf{Função Objetivo}


\begin{itemize}

\item Minimizar o Custo de Instalação e Operação:

\begin{equation}
 \sum_{mn} C_{mn}\cdot D_{mn} + \sum_{sijw} T\cdot q_{sw}^{ij}\cdot A_s \,,\quad \mbox{\small$i\neq s$}
\label{fo:MinC}
\end{equation}

\end{itemize}

\textbf{Restrições}

\begin{itemize}
 \item Restrição de Continuidade de Comprimentos de Onda e Limitação de Capacidade:

\begin{equation}
\sum_{s} q_{sw}^{iv}\cdot A_s \leqslant Cap\cdot \left(\sum_{m} B_{iw}^{mv} - \sum_{n} B_{iw}^{vn}\right) \Forall{(v,i,w)}
\label{rest:DefCapFlow}
\end{equation} 

\item Topologia Física:

\begin{equation}
\sum_i B_{iw}^{mn} \leqslant D_{mn} \Forall{(m,n,w)}
\label{rest:DefFis}
\end{equation} 

\item Conservação de Fluxo:

\begin{equation}
\sum_{jw} q_{vw}^{vj} = 1 \Forall{v} 
\label{rest:ConservFlowOut}
\end{equation} 
 
\begin{equation}
\sum_{iw} q_{sw}^{iv} - \sum_{jw} q_{sw}^{vj} = Q_{sv} \Forall{(v,s)}
\label{rest:ConservFlow}
\end{equation}
 
\end{itemize}

Nas próximas seções deste capítulo, as restrições da versão básica do modelo TWA serão analisadas detalhadamente. Outros casos de uso e extenções ao modelo
básico serão apresentados no capítulo segunte. 

\section{Continuidade de Comprimentos de Onda e Capacidade}
\label{cap:twa-sec:Bconserv_Cap}

A Restrição \ref{rest:DefCapFlow} acumula múltiplas funções, além de atuar como restrição de continuidade de comprimentos de onda e limitação de
capacidade, ele também garante a continuidade das rotas físicas. Para cada uma destas, os componentes topológicos devem formar uma cominho sobre a
topologia física, conservando o mesmo comprimento de onda. Esses percursos não são controlados explicitamente; eles são garantidos pela conservação dos
componetes topológicos nos nós intermediários, como uma restrição de conservação de fluxo. A soma do componentes das ligações lógicas
iniciadas em um nó $i$, partindo de um nó intermediário $v$, deve ser menor ou igual à quantidade recebida. Isso é garantido se a equação \ref{eq:ConserB}
for satisfeita.

\begin{equation}
   \sum_{n} B_{iw}^{vn} \leqslant \sum_{m} B_{iw}^{mv}  \Forall{(v,i,w)}
   \label{eq:ConserB}
\end{equation}

A equação \ref{eq:ConserB} pode ser reescrita na forma da equação \ref{eq:ConserBdif}, que define $Diff_{i,w}^v$, a diferença entre a soma dos
componentes chegando e saindo de $v$, originados em $i$ com comprimento de onda $w$. Por sua vez, a equação \ref{eq:ConserBdif} é equivalente à equação
\ref{eq:ConserBcap}. Este última é garantida pela Restrição \ref{rest:DefCapFlow}, como fica demostrado pela equação \ref{eq:ConserBfim}. O valor
$Diff_{i,w}^v$ representa a quantidade de ligações lógicas que não têm continuidade ao passar por $v$, ou seja, são as ligações lógicas incidentes em $v$
com origem em $i$.

\begin{equation}
  Diff_{i,w}^v = \sum_{m} B_{iw}^{mv} - \sum_{n} B_{iw}^{vn} \geqslant 0 \Forall{(v,i,w)}
   \label{eq:ConserBdif}
\end{equation}

\begin{equation}
   0  \leqslant Cap\cdot Diff_{i,w}^v \Forall{(v,i,w)}
   \label{eq:ConserBcap}
\end{equation}

\begin{equation}
   \sum_{s} q_{sw}^{iv}\cdot A_s  \leqslant Cap\cdot Diff_{i,w}^v \Forall{(v,i,w)}
   \label{eq:ConserBfim}
\end{equation}

Na figura \ref{fig:Bconserv} é ilustrada a forma como a conservação dos percursos lógicos é feita. No item $a$ vê-se dois componentes chegando no
nó intermediário $v$, ambos compoem ligações lógicas iniciadas em $i$, que não está representado na figura, com o mesmo comprimento de onda. Igualmente ao
componente que deixa $v$. A soma dos componentes que chegam é $3$ e a dos que saem é $2$, portanto a conservação está mantida. Neste exemplo, como há
diferença de $1$ entre a quatidade de componentes chegando e saindo de $v$, então, necessariamente há $1$ ligação lógica terminando em $v$; para a qual
ele deixa de ser visto como um nó intermediário, se tornando o destino dessa ligação lógica. A conservação não seria mantida caso houvessem componentes
partindo de $v$ em maior quantidade do que chegando, pois ai não haveria rastreabilidade do percurso até sua origem $i$. 

Ainda na Figura
\ref{fig:Bconserv}, são mostradas duas possibilidades de interpretação dos componentes topológicos. Necessariamente duas ligações lógicas passam
transparentemente por $v$, enquanto uma nele termina. Mas as informações presentes não permitem determinar por qual componente chega a ligação lógica
incidente em $v$. Isso poderia ser decidido analisando todo o conjunto de componentes das ligações lógicas originadas em $i$ no comprimento de onda $w$.
Mas pode não haver um único arranjo possível, ou seja, o TWA não modela o exato percurso físico das ligações lógicas. Todavia, isso não interfere na
modelagem do restante do problema e não precisa ser resolvido nesta fase do projeto. De posse da solução provida pelo TWA, as
rotas que possuirem alternativas de configuração podem ser decididas levando-se em consideração outras métricas não abordadas aqui, como por exemplo o fator
BL, que pondera tráfego com a distância percorrida sobre a topologia física \cite{Agrawal97}. Este comportamento contribui para que o TWA seja um modelo
enxuto, ao mesmo tempo que representa uma limitação.
 
\begin{figure}[htb]
	\centering
	\includegraphics[bb=106 272 452 749,scale=0.7]{./figs/B_conserv.eps}
	% B_conserv.eps: 0x0 pixel, 300dpi, 0.00x0.00 cm, bb=106 272 452 749
	\caption{Conservação dos Percursos Lógicos e possibilidades de interpretação dos componentes.}
	\label{fig:Bconserv}
\end{figure}

Como os componentes topológicos e as frações de
fluxo são indexadas pelo comprimento de onda, a distribuição tráfego é feita em partes disjuntas da topologia lógica, também separadas por comprimento de
onda. Na Figura \ref{fig:planos_logicos} é representada a separação da topologia lógica por comprimentos de onda. Essas porções disjuntas da topologia
lógica são vistas na figura como planos parelelos que, quando sobrepostos, formam a topologia. Esses planos serão aqui chamados de planos lógicos, cada um
associado a um comprimento de onda $w$, onde um par $(i,j)$ pode ainda representar multiplas ligações lógicas.  

\begin{figure}[htb]
	\centering
	\includegraphics[bb=152 525 500 792,scale=0.7]{./figs/planos_logicos.eps}
	% planos_logicos.eps: 0x0 pixel, 300dpi, 0.00x0.00 cm, bb=152 524 442 792
	\caption{Esquema da separação da topolologia lógica por comprimento de onda.}
	\label{fig:planos_logicos}
\end{figure}

A Restrição \ref{rest:DefCapFlow} é um conjunto de equações, onde cada uma trata de um par $(i,j)$ em um plano lógico $w$. Portanto, a capacidade das
ligações lógicas associadas ao par $(i,j)$ é $Cap\cdot Diff_{i,w}^j$, pois $Diff_{i,w}^j$ (equação \ref{eq:ConserBdif}) representa o número de ligações
lógicas entre $(i,j)$ no plano lógico $w$. Todo o tráfego passando pelas ligações lógicas $(i,j)$ nesse plano deve ser limitado por $Cap\cdot
Diff_{i,w}^j$, o que de fato é feito pela Restrição \ref{rest:DefCapFlow}. 

Como o TWA não modela explicitamente as ligações lógicas entre o par $(i,j)$, também não fica definida a divisão de tráfego alocado nelas. Embora sempre
haja banda suficiente para atender ao tráfego alocado ao conjunto dessas ligações lógicas, respeitando à capacidade individual. A exata divisão do tráfego
também pode ser definida em outra fase do projeto e não precisa ser modelada aqui, o que também comtribui para a simplicidade do modelo. 

Como não é modelado o exato tráfego em cada ligação lógica, não é possível minimizar diretamente o congestionamento \cite{ram02}. Mas, a capacidade das
ligações lógicas pode exercer o papel de limitante superior (\textit{upper bound}) para o congestionamento. Conjuntamente com a minimização do tráfego na
função objetivo, como foi comentado na Seção \ref{cap:twa-sec:funcaoobjetivo}, temos uma boa abordagem para tratar do congestionamento, como foi demostrado
em \cite{Renato06}.

A Restrição \ref{rest:DefCapFlow} ainda acumula uma função que, por ser intuitiva, pode passar despercebida. Mas é fundamental para a conscistência do
modelo. Ela anula as frações de fluxo agregado entre os nós não conectados diretamente por ligações lógicas. Quando $Diff_{i,w}^j = 0$, ou seja, não
há ligações lógicas entre o par $(i,j)$ no plano $w$, as frações de fluxo $q_{sw}^{ij}$ serão anuladas pela Restrição \ref{rest:DefCapFlow}, para todas as
origens $s$.

Como o número de componentes topológicos é $N³\cdot W\cdot K$ e o número de restrições é $\Theta(N²\cdotp W)$, o número de variáveis na forma básica do
modelo é da ordem de $\Theta(N³\cdotp W\cdot K)$. Portanto, em número de variáveis e restrições, o TWA é similar a modelos eficientes, mas que resolvem
apenas o sub-problema RWA, como os que foram estudados em \cite{Jaumard04}.

\section{Topologia Física e Consevação de Fluxo}

A Restrição \ref{rest:DefFis} acumula nas variáveis $D_{mn}$ a multiplicidade determinada pelos componentes topológicos

Pela forma como $D_{mn}$ é calculada na Restrição \ref{rest:DefFis}, a rigor, seu valor poderia ser maior do que é determinado pelos componentes
topológicos.
Mas
isso não ocorre quando o número de ligações físicas for minimizado na função objetivo.


 não é controlada a existência de $D_{i,j}\neq 0$, com $B_{s,i,j,w}=0$, $\forall (s,w)$. 
Dependendo do caso de uso, isso ou não influencia no resultado, ou pode ser controlado indiretamente pela função objetivo, 
por exemplo, por meio do custo de instalação. Opcionalmente poderia-se usar para este fim uma restrição da forma $\sum_{s,w} 
B_{s,i,j,w} \geq D_{i,j}$, para todo $(i,j)$, mas essa hipótese é por hora desconsiderada.


Na Figura \ref{fig:varDmn} está um exemplo de interpretação dos componentes topológicos na variável $D_{mn}$. No item $a$ estão os componentes topológicos
que definem as ligações físicas indicadas no item $b$. Nos itens $c$ e $d$ estão as ligações lógicas e as rotas físicas correspondentes.

\begin{var}
\label{FisVar}
 Seja $D_{mn} \in \{0,..,K\}$ o número de ligações físicas entre o par de nós $(m,n)$. 
\end{var}

\begin{figure}[htb]
	\centering
	\includegraphics[bb=37 371 534 812, scale=0.7]{./figs/Var_Dmn.eps}
	% Var_Dmn.eps: 0x0 pixel, 300dpi, 0.00x0.00 cm, bb=34 593 536 800
	\caption{Interpretação dos componentes topológicos na variável $D_{mn}$.}
	\label{fig:varDmn}
\end{figure}


A conservação de fluxo é assegurada pela Restrição \ref{rest:ConservFlow}, que também garante o envio e a entrega das demandas 
de tráfego. As equações da Restrição \ref{rest:ConservFlow} são semelhantes às encontradas na modelagem agregada 
para o VTD \cite{ram02}. Todavia, sua interpretação é sutilmente diferente, pois aqui uma determinada fração de fluxo de tráfego pode ser
subdividida e transportada simultaneamente por mais de uma ligação lógica entre o par $(i,j)$. Por exemplo, em comprimentos de onda diferentes em um mesmo enlace
físico $(m,n)$ que interliga diretamente $(i,j)$, ou por rotas físicas disjuntas entre os nós $(i,j)$, neste último caso, independente do
comprimento de onda.


