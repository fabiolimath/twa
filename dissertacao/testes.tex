
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Experimentos Computacionais
%% Copyright 2009 Fabio de Oliveira Lima.
%% Este documento é distribuído nos termos da licença 
%% GNU General Public License v2.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Experimentos Computacionais}
\label{cap:testes}

Para avaliar a pertinência do modelo de otimização TWA, que consiste na nova abordagem proposta neste trabalho, testes computacionais foram realizados. Toda
a modelagem do TWA foi escrita em AMPL\rr (\textit{A Modeling Language for Mathematical Programming}), de modo que facilmente 
possa ser adaptada para várias finalidades. No Capítulo \ref{cap:ferramentas} há um resumo sobre todas as ferramentas computacionais utilizadas neste
trabalho, suas versões e outras informações. 

Nos testes apresentados neste capítulo, para resolver os modelos de programação inteira mista, foi utilizado o
programa SCIP (\textit{Solving Constraint Integer Programs}), com as instâncias no formato FreeMPS. A versão do SCIP usada utiliza internamente o CLP
(\textit{Coin-or Linear Programming}) para resolver subproblemas de programação linear. O programa GLPK foi utilizado para resolver modelos de programação
inteira e converter código AMPL em FreeMPS, antes de ser passado ao SCIP. Na resolução dos
modelos de programação linear e programação linear inteira mista, citados ao longo deste capítulo, a precisão nos cálculos adotada foi de $10^{-6}$.

Os testes da Seção \ref{cap:testes-sec:karcius} foram realizados em uma estação de trabalho com a seguinte configuração: 
\textit{notebook} \textit{PC};
com sistema operacional \textit{GNU/Linux Kubuntu}, versão $8.04$ $32 bits$;
equipada com processador \textit{Sempron Mobile\rr $3500+$} $1.8 GHz$, com $512 KB$ de \textit{cache} e $2GB$ de RAM.

O computador onde foram executados os experimentos da Seção \ref{cap:testes-sec:sivarajan} possui a seguinte configuração: 
\textit{desktop} \textit{PC};
executando o sistema operacional \textit{GNU/Linux Kubuntu}, versão $ 9.04$ $32 bits$;
equipada com processador \textit{Intel Pentium\rr $4$} $3.00GHz$ de $2$ núcleos, com $2048 KB$ de \textit{cache} e $1.5GB$ de RAM.

Vale observar que o SCIP, o CLP e o GLPK são \textit{softwares} livres, de código fonte aberto e de distribuição gratuita. Da mesma forma que os sistemas
operacionais e demais ferramentas computacionais utilizadas neste trabalho, como é descrito no Capítulo \ref{cap:ferramentas}.

Os resultados dos experimentos computacionais realizados com o TWA são comparados, neste capítulo, com os
publicados em \cite{Karcius04} e \cite{Sivarajan01}, trabalhos em que foram propostos modelos para a resolução integrada do VTD e RWA. Todavia, ambos os
modelos não incluem
a topologia física como uma variável, diferente do TWA, o que consiste, em termos de possibilidades de projeto da rede óptica, em um avanço com relação a
estas formulações anteriormente propostas. Por esse motivo, para podermos produzir resultados passíveis de comparação, nos testes que
veremos mais adiante neste capítulo, a topologia física da rede é um dado de entrada. O modelo proposto em \cite{Karcius04} será aqui chamado de AW, e o
modelo proposto em \cite{Sivarajan01} será chamado de KS.

\section{O Modelo AW}


A modelagem encontrada em \cite{Karcius04} é baseada nas modelagens clássicas desses problemas \cite{ram02, Zang00}.
O modelo AW, como a forma básica do TWA, não considera conversões entre comprimentos de onda. 

Reproduzimos a seguir a formulação matemática encontrada em
\cite{Karcius04}. Este é um modelo de programação linear inteira mista, que combina variáveis reais e variáveis discretas. Ele considera os quatro
subproblemas do projeto de uma WRON. 

A topologia física é considerada conhecida, sendo passada como parâmetro para o modelo. Além disso, é suposto que ela
seja bidirecional. Os demais dados de entrada seguem as definições adotadas pelo TWA, e são resumidos a seguir. 

% Em \cite{Karcius04} são consideradas $3$ funções objetivo ao longo do texto, usadas em diferentes momentos, elas também estão descritas abaixo.

\begin{dados}
\label{aw:Cons}
Uma instância para o modelo AW é definida por:
\begin{enumerate}
\item $N$ $=$ Número de nós da rede.
\item $W$ $=$ Máximo de comprimentos de onda em uma ligação física.
\item $P_{sd}$ $=$ Demanda de tráfego, com origem $s$ e destino $d$.
\item $DD_{mn}$ $=$ ligação física bidirecional entre o par $(m,n)$.
\item $GLout_v$ $=$ Grau Lógico de saída do nó $v$.
\item $GLin_v$ $=$ Grau Lógico de entrada do nó $v$.
\end{enumerate}
\end{dados}


\begin{vars} Variáveis do modelo AW:
\label{aw:vars}
\begin{enumerate}
\item $b_{ij}\in \{0,1\}$, registra a presença ou ausência da ligação lógica $(i,j)$.

\item  $b_{ijw}\in \{0,1\}$, indica o comprimento de onda $w$ utilizado pela ligação lógica $(i,j)$.

\item  $p_{mn}^{ij}\in \{0,1\}$, indica se a rota física de $(i,j)$ passa pela ligação física $(m,n)$.

\item  $p_{mnw}^{ij}\in \{0,1\}$, indica se $w$ é utilizado por $(i,j)$ ao passar por $(m,n)$.

\item  $\lambda_{ij}^{sd}\in \mathbb{R^+}$, quantidade de tráfego fluindo de $s$ para $d$, passando por $(i,j)$.

\item  $\lambda_{ij} = \displaystyle\sum_{sd} \lambda_{ij}^{sd}$, tráfego total na ligação lógica $(i,j)$.

\item  $\lambda_{max} \in \mathbb{R^+}$, Congestionamento da rede.

\item  $L\in \mathbb{N}$, número de ligações lógicas na ligação física mais carregada, com $L\leqslant W$. 

\end{enumerate}
\end{vars}

\textbf{Função Objetivo}
\begin{itemize}

\item Minimize o Congestionamento:
\begin{equation}
\lambda_{max}
\label{aw:fo:hmax}
\end{equation}

\end{itemize}

\textbf{Restrições}

\begin{itemize}

\item Fluxo total em uma ligação lógica:

\begin{equation}
 \lambda_{ij}^{sd}  \leqslant b_{ij}\cdot P_{sd} \Forall{(i,j,s,d)}
\label{aw:rest:totFlow2}
\end{equation}

\item Roteamento na topologia física:

\begin{equation}
 \sum_n p_{mn}^{ij} = \sum_n p_{nm}^{ij} \Forall{(i,j,m)}, \mbox{ com $m\neq i$ e $m\neq j$.}
\label{aw:rest:rotas}
\end{equation}

\begin{equation}
 \sum_n p_{in}^{ij} = b_{ij} \Forall{(i,j)}
\label{aw:rest:rotas2}
\end{equation}

\begin{equation}
 \sum_m p_{mj}^{ij} = b_{ij} \Forall{(i,j)}
\label{aw:rest:rotas3}
\end{equation}

\item Alocação e continuidade de comprimentos de onda:

\begin{equation}
 \sum_n p_{mnw}^{ij} = \sum_n p_{nmw}^{ij} \Forall{(i,j,m,w)}, \mbox{ com $m\neq i$ e $m\neq j$.}
\label{aw:rest:w}
\end{equation}

\begin{equation}
 \sum_n p_{inw}^{ij} = b_{ijw} \Forall{(i,j,w)}
\label{aw:rest:w2}
\end{equation}

\begin{equation}
 \sum_m p_{mjw}^{ij} = b_{ijw} \Forall{(i,j,w)}
\label{aw:rest:w3}
\end{equation}

\begin{equation}
 \sum_w b_{ijw} = b_{ij} \Forall{(i,j)}
\label{aw:rest:w4}
\end{equation}

\begin{equation}
 \sum_w p_{mnw}^{ij} = p_{nm}^{ij} \Forall{(i,j,m,n)}
\label{aw:rest:w6}
\end{equation}

\item Topologia Física:

\begin{equation}
 \sum_{ij} p_{mn}^{ij} \leqslant L\cdot DD_{mn} \Forall{(m,n)}
\label{aw:rest:fis1}
\end{equation}

\begin{equation}
 \sum_{ij} p_{mnw}^{ij} \leqslant DD_{mn} \Forall{(m,n,w)}
\label{aw:rest:fis2}
\end{equation}

\item Conservação de fluxo em cada nó:

\begin{equation}
 \forall \,  \mbox{\small$(i,s,d)$}, \quad \sum_j \lambda_{ij}^{sd} - \sum_j \lambda_{ji}^{sd} = \left\{\begin{aligned} P_{sd}, & \quad s=i\\
                                                  -P_{sd}, & \quad d=i\\
						        0, & \quad \text{caso contrário} \end{aligned}\right.
\label{aw:rest:Flow}
\end{equation}

\item Congestionamento:

\begin{equation}
 \lambda_{ij} = \sum_{sd} \lambda_{ij}^{sd} \Forall{(i,j)}
\label{aw:rest:defCong}
\end{equation}

\begin{equation}
 \lambda_{ij} \leqslant \lambda_{max} \Forall{(i,j)}
\label{aw:rest:Cong}
\end{equation}

\item Grau lógico:

\begin{equation}
\sum_j  b_{ij}  \leqslant GLout_i \Forall{i}
\label{aw:rest:lg1}
\end{equation}

\begin{equation}
\sum_i  b_{ij}  \leqslant GLin_j \Forall{j}
\label{aw:rest:gl2}
\end{equation}

\end{itemize}

As principais diferenças entre o AW e o TWA são que o modelo AW não faz nenhum tipo de agregação de variáveis e separa cada aspecto do projeto em variáveis
de decisão diferentes. Isso facilita a interpretação de cada funcionalidade do modelo e o controle de cada métrica, embora torne o modelo pouco conciso.
Entretanto, o modelo AW não é afetado por nenhuma das limitações a quais o TWA está sujeito, como foi discutido na Seção \ref{cap:twa-sec:limitacoes}. 

O AW
é mais abrangente que o TWA em alguns aspectos, mas em outros não. A principal vantagem dele, em relação ao TWA, é que as rotas físicas e a distribuição do
tráfego são bem definidas, ao contrário do TWA que permite que haja mais de uma forma de configurá-las. Portanto, a distância percorrida pelo tráfego pode
ser controlada, apesar disso não ter sido explorado em \cite{Karcius04}. Além disso, não foi prevista em \cite{Karcius04} a possibilidade da topologia
física ser uma das variáveis do problema, e nem dela possuir multiplicidade de ligações físicas. 

As restrições do AW que tratam do VTD não suportam multiplicidade de ligações lógicas, especificamente a restrição \ref{aw:rest:totFlow2}, pois geraria mais
tráfego do que existe na matriz de demandas $P_{sd}$. Para este fim, seria necessária uma restrição de limitação de capacidade nos moldes da Restrição
\ref{rest:DefCapFlow} do TWA. No AW não há uma restrição com funcionalidade equivalente. Em razão da topologia lógica não possuir
multiplicidade de ligações, as variáveis de \ref{aw:vars}.2 a \ref{aw:vars}.4 acabam sendo binárias, embora as demais restrições do AW não tenham essa
limitação. Na relação a seguir são comparados paralelamente os modelos AW e TWA, em termos de funcionalidade.

\begin{itemize}
	\item As variáveis de \ref{aw:vars}.1 a \ref{aw:vars}.4 correspondem ao componente topológico do TWA, definido na Variável \ref{twa:var:B};
	\item A variável \ref{aw:vars}.5 corresponde à fração de tráfego agregado, Variável \ref{FlowVar};
	\item As Restrições de \ref{aw:rest:totFlow2} a \ref{aw:rest:w6} correspondem a Restrição \ref{rest:DefCapFlow}, de continuidade de comprimentos de
	onda e limitação de capacidade, mas sem suportar multiplicidade de ligações lógicas;
	\item As Restrições \ref{aw:rest:fis1} e \ref{aw:rest:fis2} correspondem a Restrição \ref{rest:DefFis}, de controle da topologia física, no
sentido de limitação dos componentes topológicos, como foi comentado na Seção \ref{cap:cases-sec:fis};
	\item A Restrição \ref{aw:rest:Flow} corresponde as restrições de conservação de fluxo \ref{rest:ConservFlowOut} e \ref{rest:ConservFlow};
	\item O controle do congestionamento equivale ao que foi feito na Seção \ref{Cong};
	\item O controle do grau lógico equivale ao que foi feito na Seção \ref{ConservGl};
% 	\item O controle do número de ligações lógicas em cada ligação física equivale ao que foi feito na Seção \ref{LimW};
% 	\item O controle do número de saltos físicos equivale ao que foi feito na Seção \ref{cap:cases-sec:LimB};
\end{itemize}

Na tabela \ref{tab:aw:num_var} estão resumidos os dados a cerca do número de variáveis binárias, de variáveis reais e do número equações no modelo AW. Eles
são apresentados em notação assintótica e em valores absolutos. Para fins de comparação, vale relembrar neste ponto que o modelo AW não suporta
multiplicidade de ligações lógicas nem físicas, além de considerar a topologia física como um dado de entrada.
 
\begin{table}[htb]
{%
\newcommand{\mc}[3]{\multicolumn{#1}{#2}{#3}}
\begin{center}
\begin{tabular}{llll}\hline
\mc{1}{|c|}{Métrica} & \mc{1}{c|}{Equações} & \mc{1}{l|}{Reais} & \mc{1}{|l|}{Binárias}\\\hline
\mc{1}{|l|}{Custo Assintótico} & \mc{1}{|l|}{$\Theta(N^4 + N^3\cdot W)$} & \mc{1}{|l|}{$\Theta(N^4)$} & \mc{1}{|l|}{$\Theta(N^4\cdotp W)$}\\\hline
\mc{1}{|l|}{Valores Absolutos} & \mc{1}{|l|}{$2\!\cdot\!N^4\!+\!N^3\!\cdotp\!(2\!+\!W)+N^2\!\cdotp\!(5\!+\!3\cdotp\!W)+2\!\cdotp\!N$} &
\mc{1}{|l|}{$N^4$} & \mc{1}{|l|}{$(N^4\!+\!N^2)\!\cdotp\!(W\!+\!1)$}\\\hline
\end{tabular}
\end{center}
}%
\caption{Numero de variáveis binárias, reais e equações no modelo AW.}
\label{tab:aw:num_var}
\end{table}

\subsection{Resultados com o Modelo AW}

Em \cite{Karcius04} foi proposto um algoritmo hibrido, que combina programação linear inteira com a heurística HLDA \cite{ram96}, uma heurística para a
escolha da topologia lógica, sobra a qual comentou-se na Seção \ref{intro:VTD}. Para a estratégia proposta, foram derivados do AW dois outros modelos que
serão chamados de AW-$s$ e AW-$l$. Ambos são formados por subconjuntos das restrições e variáveis do modelo AW, e com funções objetivo próprias,
apresentadas a seguir. 

\textbf{Funções Objetivo}
\begin{itemize}

\item AW-$l$: Minimize o Máximo de Ligações Lógicas em Cada Ligação Física:
\begin{equation}
L
\label{aw:fo:L}
\end{equation}


\item AW-$s$: Minimize o Número de Saltos Físicos:
\begin{equation}
\sum_{mnij} p_{mn}^{ij} = S
\label{aw:fo:B}
\end{equation}

\end{itemize}
     
     As Restrições de \ref{aw:rest:rotas} a \ref{aw:rest:rotas3}, mais a restrição \ref{aw:rest:fis1}, completam o modelo AW-$l$. Por sua vez, o  modelo
AW-$s$ é composto pela restrições de \ref{aw:rest:rotas} a \ref{aw:rest:fis2}, portanto, contém as restrições de AW-$l$. Nota-se que, com esses conjuntos
de restrições, a Variável \ref{aw:vars}.5 é excluída e o subproblema da distribuição do tráfego também. Do VTD, resta apenas as variáveis de topologia
lógica, que serão escolhidas pelo HLDA e passadas aos modelos derivados como um dado de entrada. Definida a topologia lógica, a distribuição do tráfego é um
problema de programação linear de fácil resolução \cite{ram02}, deixado para ser resolvido em uma fase posterior do projeto. 

Sem a distribuição de tráfego, os modelos derivados são modelos de programação inteira, e não mais um MILP como o AW. Além disso, como a
topologia lógica é um dado de entrada, os modelos AW-$s$ e AW-$l$ modelam apenas os subproblemas RWA e WR (Rotas físicas), respectivamente \cite{Zang00}.
Deste modo, a distribuição das demandas de tráfego não influencia esses subproblemas diretamente, prejudicando o conceito de projeto completo da rede.
Os modelos derivados não herdam o impedimento de multiplicidade de ligações lógicas do AW. Além disso, o HLDA pode prover topologias lógicas com
multiplicidade de ligações. Assim, as variáveis de \ref{aw:vars}.2 a \ref{aw:vars}.4 podem passar a suportar multiplicidade de ligações lógicas. O que de
fato é assumido em \cite{Karcius04}.

O HLDA recebe como entrada a matriz de demandas de tráfego e um grau lógico para a rede. A partir disso, ele constrói uma topologia lógica sem fazer
distribuição
de tráfego. Assim, o grau lógico $G$ define as instâncias nos testes. Definida a topologia lógica pelo HLDA, o modelo AW-$l$ é utilizado para determinar as
rotas físicas, minimizando $L$. A solução para as rotas físicas é passada ao modelo AW-$s$, para re-otimização, fixado $L$. Nesta fase, à instância é
passado
também um limite $W$, o máximo de comprimentos de onda que poderão ser usados. E no final é registrada a quantidade de comprimentos de onda de fato
utilizada. Paralelamente a função objetivo do AW-$s$ retira os ciclos nas rotas físicas. O objetivo desta última etapa é obter uma solução viável que atenda
ao $L$, à topologia lógica e ao $W$ fixados, retirando os ciclos na solução final. As métricas de interesse nessa abordagem são listadas a seguir, com uma
breve descrição de seu relacionamento com o método proposto em \cite{Karcius04}. 

\begin{enumerate}
	\item $G$: o grau lógico, define as instâncias.
	\item Congestionamento: não é calculado, pois o tráfego não é distribuído; confia-se na qualidade da topologia lógica provida pelo HLDA (etapa $1$);
	\item $L$: é minimizado diretamente na etapa $2$, quando se determina as rotas físicas;
	\item $W$: não é minimizado diretamente na re-otimização (etapa $3$), ele é limitado em cada instância, de modo a obter uma solução viável que
atenda
às rotas físicas, para $L$ fixado;
	\item $S$: não é uma métrica de particular interesse, foi minimizada apenas para remover ciclos nas rotas físicas na etapa $3$.
\end{enumerate}

Os testes descritos nesta seção foram realizados em um Intel Pentium IV/1.6Ghz usando o  CPLEX{\rr} (\url{www.cplex.com}), uma ferramenta de otimização
comercial, de código fonte fechado. Para cada instância, o tempo de otimização foi limitado em $1$ hora.

% Esse método é resumido na listagem a seguir. 
% \begin{enumerate}
% 	\item Inicialmente, a topologia Lógica é escolhida pelo HLDA;
% 	\item A distribuição do tráfego não é resolvida;
% 	\item Em seguida, a topologia Lógica é passada ao modelo AW-$l$ para determinar as rotas físicas, minimizando $L$.
% 	\item Por fim, a solução do AW-$l$ é passada ao modelo AW-$s$ para re-otimização e alocação de comprimentos de onda, com um dado limite $W$. Nesta
% fase $S$ é minimizado para retirar ciclos
% \end{enumerate}

\section{Comparação com o modelo AW}
\label{cap:testes-sec:karcius}

Nesta seção serão apresentados resultados produzidos utilizando o modelo TWA, que serão comparados com os encontrados em \cite{Karcius04}, nos quais
utilizou-se o modelo AW descrito na seção anterior. As duas abordagens serão comparadas em termos do esforço computacional e da qualidade das soluções
quanto às métricas de interesse. São elas: o número de ligações lógicas ($L$) e o
número de comprimentos de onda disponíveis em cada ligação física ($W$); o grau lógico da rede ($G$); o número de saltos físicos na topologia ($S$); e o
congestionamento. Esses parâmetros são comumente tratados nas investigações a cerca do RWA \cite{Zang00}.

% Também é controlado o congestionamento, que é uma conhecida métrica para o VTD. Isso é feito através da clássica heurística HLDA \cite{ram02,
% sbpo04}, gerando uma solução para o VTD que alimenta as etapas seguintes do procedimento, conforme apresentado em \cite{Karcius04}. Para cada grau
% lógico, o HLDA produz de forma determinística uma topologia lógica, baseado na matriz de demandas. A solução para o VTD é completada distribuindo o
% tráfego sobre esta topologia, através de um modelo de programação linear \cite{ram02}.

Para produzir resultados passíveis de comparação, são acrescentadas à modelagem básica do TWA, mostrada na Seção \ref{Basic}, as restrições de 
controle do grau lógico (Restrição \ref{ConservGl}) e a de limitação do número de ligações lógicas em cada ligação física (Seção \ref{LimW}).
Como os resultados em \cite{Karcius04} foram produzidos para topologias físicas sem multiplicidade, será adotado $K=1$. Deste modo, para controlar o número
de ligações lógicas é usada a restrição Restrição \ref{L}, adequada para topologias físicas sem multiplicidade. Além disso, a definição dos componentes
topológicos é modificada, deixando de ser uma variável inteira, passando a ser binária, pois agora compõem uma topologia física sem multiplicidade.
A função objetivo do modelo
básico é substituída pela minimização do número de saltos físicos (Seção \ref{cap:cases-sec:LimB}), para compatibilizar os resultados com aqueles que serão
alvo de comparação. Esta formulação específica, apresentada a seguir, é denominada de TWA-$sl$. 
     
\begin{dados}
\label{testes:Cons}
Uma instância para o modelo TWA-$sl$ é definida por:

\begin{enumerate}
\item $N$ $=$ Número de nós da rede.
\item $W$ $=$ Máximo de comprimentos de onda em uma ligação física.
\item $L$ $=$ Máximo de ligações lógicas em uma ligação física, com $L \leqslant W$.
\item $G$ $=$ Grau lógico da rede.
% \item $H$ $=$ Grau físico máximo de entrada e saída de cada nó.
\item $Cap$ $=$ $\lceil HLDA_c\rceil$, capacidade de tráfego de cada ligação lógica.
\item $P_{sd}$ $=$ Demanda de tráfego, com origem $s$ e destino $d$.
\item $D_{mn}$ $=$ Ligação Física, com origem $m$ e destino $n$.
\item $A_s = \sum_d P_{sd} =$ Tráfego agregado pela origem $s$. 
\item $Q_{sd}=P_{sd}/A_s =$ Fração de $A_s$ correspondente à Demanda de tráfego $P_{sd}$.
\end{enumerate}
\end{dados}

\begin{var}
\label{testes:var:B}
 Seja $B_{iw}^{mn} \in \{0,1\}$, com $i\neq n$, um componente do conjunto das ligações lógicas com origem $i$ e
comprimento de onda $w$, que utilizam a ligação física $(m,n)$  (versão sem multiplicidade física).
\end{var}

\begin{var}
 \label{testes:FlowVar}
 Seja $q_{sw}^{ij} \in [0,1]$ a fração do fluxo originado em $s$, passando pelas ligações lógicas entre o par $(i,j)$ com comprimento de onda $w$,
onde $s\neq j$. 
\end{var}

\textbf{Função Objetivo}

\begin{itemize}

\item Minimizar o Número de Saltos Físicos

\begin{equation} 
     \sum_{imnw} B_{iw}^{mn} = S
\label{testes:fo:B}
\end{equation}

\end{itemize}
    
\textbf{Restrições}

\begin{itemize}
 \item Continuidade de Comprimentos de Onda e Capacidade:

\begin{equation}
\sum_{s} q_{sw}^{iv}\cdot A_s \leqslant Cap\cdot \left(\sum_{m} B_{iw}^{mv} - \sum_{n} B_{iw}^{vn}\right) \Forall{(i,v,w)} \mbox{, com $i\neq v$}
\label{testes:rest:DefCapFlow}
\end{equation} 

\item Topologia Física:

\begin{equation}
\sum_i B_{iw}^{mn} \leqslant D_{mn} \Forall{(m,n,w)}
\label{testes:rest:DefFis}
\end{equation} 

\item Conservação de Fluxo:

\begin{equation}
\sum_{jw} q_{vw}^{vj} = 1 \Forall{v} 
\label{testes:rest:ConservFlowOut}
\end{equation} 
 
\begin{equation}
\sum_{iw} q_{sw}^{iv} - \sum_{jw} q_{sw}^{vj} = Q_{sv} \Forall{(s,v)} \mbox{, com $s\neq v$}
\label{testes:rest:ConservFlow}
\end{equation}

 	\item Controle do Grau lógico:

\begin{equation}
\sum_{wn} B_{vw}^{vn} \leqslant G \Forall{v}
\label{testes:rest:GLout}
\end{equation} 

\begin{equation}
\sum_{iwm} B_{iw}^{mv} - \sum_{iwn} B_{iw}^{vn} \leqslant G \Forall{v},\, \mbox{\small$i\neq v$} 
\label{testes:rest:GLin}
\end{equation} 

 \item Ligações Lógicas em Cada Ligação Física:

\begin{equation}
 \label{testes:L}
\sum_{iw} B_{iw}^{mn}\leqslant L\Forall{(m,n)}
\end{equation}

\end{itemize}

    Nos resultados apresentados em \cite{Karcius04} não e calculado o congestionamento, apenas é adotada a topologia lógica produzida pela heurística HLDA.
Deste modo, foram obtidas topologias lógicas com uma implementação da heurística HLDA.
Para cada uma delas, foi distribuído o tráfego e calculado o congestionamento ($HLDA_c$) através do GLPK, utilizando uma versão do modelo clássico
para o VTD \cite{ram02}. Assim, como limitação de capacidade na Restrição \ref{testes:rest:DefCapFlow}, foi adotado $Cap = \lceil HLDA_c\rceil$. Para cada
instância, esse procedimento levou menos de um segundo, portanto não será 
considerado na contagem de tempo de processamento dos resultados apresentados nesta seção.

Para produzir os resultados com o TWA-$sl$, a estratégia adotada será configurar as instâncias do problema com os menores valores possíveis para $W$ e $L$,
passando-as ao SCIP para resolução, até que se encontre seus valores ótimos. Essa abordagem só é viável por que, nas situações em que as limitações impostas
á $W$ e $L$ implicaram em uma
instância insolúvel \cite{mukherjee}, o SCIP foi capaz de identificar essa condição em menos de um segundo de execução. Esse tempo não será computado, mas
o número de vezes em que isso ocorreu sim. Esse valor será chamado de $I$; número de instâncias insolúveis. 

Em resumo, as métricas de interesse serão tratadas da seguinte forma: o grau lógico $G$ define as instâncias do problema; o congestionamento, usado como
limitação de capacidade das ligações lógicas, é obtido da solução do HLDA; o número total de saltos físicos $S$ será minimizado na função objetivo; e por
fim,
a solução completa será obtida otimizando o modelo TWA-$sl$, fixando os parâmetros $L$ e $W$ nos seus valores ótimos. 

Para determinar os parâmetros $L$ e $W$, eles são testados com o SCIP a partir do valor $1$, e serão incrementados até que se obtenha uma solução viável.
Cada incrementação de $L$ ou $W$ representa uma tentativa. Como $W$ limita $L$, este tem precedência na incrementação, sendo aumentado até se igualar à
$W$, assim por diante. 

Quando se aumenta o grau lógico, a restrição e capacidade é diminuída, pois o congestionamento diminui quando $G$ aumenta \cite{ram96}.
Assim, a configuração ótima de $L$ e $W$, para um dado $G$, é também ótima ou insolúvel para todo grau lógico maior. Desta forma, quando se encontra uma
configuração viável, está garantida a otimalidade dos parâmetros $L$ e $W$, para a específica limitação de capacidade usada. Esse procedimento é detalhado a
seguir.

\begin{enumerate}
\item Partindo do menor grau lógico ($G=1$), configurar uma instância com $W=1$ e $L=1$ e otimizar com o SCIP.

\item Enquanto o SCIP retornar que a instância é insolúvel, $L$ será incrementado até o seu limite, que é o valor atual de $W$. Quando 
$L$ não puder ser aumentado ($L=W$), então $W$ o será, e assim por diante. 

\item Se uma solução viável é encontrada, o SCIP é interrompido, a solução é registrada e o grau lógico é incrementado, dando continuidade ao processo.

\end{enumerate}

Ainda fica indefinida a otimalidade para $S$, mas garanti-la não é o objetivo aqui, pois $S$ é minimizado apenas para evitar ciclos na solução final
\cite{Karcius04}. Além disso, o SCIP sempre é interrompido ao encontrar a primeira solução viável, sem perseguir a otimalidade. Todavia, para a maioria das
instâncias, o SCIP foi capaz de determinar o otimalidade de $S$, já na primeira solução encontrada. Lembrando que, na resolução de um MILP, bem como em
muitos outros tipos de problemas de otimização, encontrar a solução ótima não equivale a determinar sua otimalidade.

%  Isso é feito com o objetivo de ``afrouxar'' as restrições de modo que o solver possa encontrar uma solução viável mais rapidamente, 
% sacrificando um pouco a qualidade das restrições. Se uma solução viável é encontrada, dentro da janela de $400$ segundos, o solver é
% interrompido, 
% a solução é registrada e o grau lógico é incrementado, dando continuidade ao processo. 
% 
% Nas situações em que o problema era insolúvel, o solver determinou isso em menos de um segundo, dificultando a separação dos tempos de leitura e
% de execução. Portanto estes tempos não foram computados. Essas situações em que o modelo precisou ser calibrado, que chamaremos de
% \textit{Instância Insolúvel} ($I$), fazem parte do método e são registradas conjuntamente com os resultados.

% Este arranjo não foi obtido ao acaso e nem por tentativa e erro. O grau lógico ($G$), o número de comprimentos de onda ($W$), a limitação de 
% ligações lógicas das ligações físicas ($L$), a capacidade do canal ($Cap$) e o número de saltos ($S$), deveriam ser controlados para viabilizar a
% comparação com o trabalho do Karcius. O parâmetro $S$ foi escolhido para a função objetivo pois, dentre as opções, era a que fornecia o modelo mais
% enxuto. Além disso, a minimização do número de saltos ajuda a evitar a formação de ciclos na solução \cite{Karcius04}. 

% Como, nesta modelagem, $W$ está diretamente relacionado a quantidade de variáveis, é mais conveniente começar com $W=1$. Disso decorre a escolha 
% de também começarmos com $G=1$ e $L=1$. A maior prioridade para a incrementação é dada ao $G$, pois variando este temos instâncias diferentes. 
% A menor precedência ficou para $W$, pois quanto menor ele for menores precisarão ser os custos de instalação da rede. Na posição intermediária 
% fica $L$, pois, minimizando-o, maximizamos a disponibilidade da rede.

%  Utilizamos o SCIP para encontrar as soluções viáveis. Além de calcular a capacidade dos canais ópticos ($Cap$), como foi descrito acima, o GLPK também
% foi
% usado para interpretar o modelo AMPL, gerando a entrada de dados para o SCIP. Os resultados que serão confrontados com os nossos foram produzidos com o
% ILOG
% CPLEX\rr (www.ilog.com/products/cplex), uma ferramenta comercial.

Foram executados dois testes computacionais, com uma rede de $6$ nós e com uma rede de $12$ nós \cite{Karcius04}. Os resultados obtidos estão
nas Tabelas \ref{N6} e \ref{N12}, cujas legendas estão resumidas na Tabela \ref{tab:legendas-Karcius}. 

\begin{table}[!ht]
\begin{center}

\begin{tabular}{|r|l|} \hline
Sigla  & Significado\\ \hline
$G$  & Grau Lógico\\
$L$   & Limitação de Ligações lógicas das Fibras\\
$W$   & Número de comprimentos de onda disponíveis\\
$S$   & Número de Saltos Físicos\\
$t$   & Tempo em segundos para encontrar a primeira solução viável\\
$Cap$ & Capacidade de Tráfego de Cada Canal Óptico\\
$I$   & Instância Insolúvel\\ \hline
% $F$   & Tentativa Falha \\ \hline
\end{tabular}

\caption{Legendas para as Tabelas \ref{N6} e \ref{N12}.}

\label{tab:legendas-Karcius}
\end{center}
\end{table}

Os resultados para a rede de $6$ nós estão na Tabela \ref{N6}. Na Figura \ref{fig:Karcius-rede6} está representada a topologia física da rede de
$6$
nós, e na Figura \ref{fig:Karcius-rede6-demandas} a matriz de demandas de tráfego \cite{Karcius04}. A primeira coluna registra o grau lógico de cada
instância
($G$), que neste caso foram $5$. Da segunda até a quarta coluna ($L$, $W$ e $S$) estão os resultados de \cite{Karcius04} e da quinta à sétima estão os 
resultados obtidos com a metodologia descrita nesta seção. Note que em todas as instâncias foram obtidos resultados melhores para todos os parâmetros.

\begin{figure}[htb]
 \centering
 \includegraphics[bb=134 613 266 697, scale=1.4]{figs/Karcius-rede6.eps}
 % Karcius-rede6.eps: 0x0 pixel, 300dpi, 0.00x0.00 cm, bb=134 613 266 697
 \caption{Topologia Física da rede de 6 nós \cite{Karcius04}.}
 \label{fig:Karcius-rede6}
\end{figure}

\begin{figure}[htb]
 \centering
 \includegraphics[bb=0 0 223 122, scale=.9]{figs/Karcius-rede6-demandas.eps}
 % Karcius-rede12-demandas.eps: 0x0 pixel, 300dpi, 0.00x0.00 cm, bb=96 243 508 387
 \caption{Matriz de demandas para a rede de 6 nós.}
 \label{fig:Karcius-rede6-demandas}
\end{figure}


\begin{table}[!ht]
\begin{center}
\begin{tabular}{c|ccc|ccc|ccc|} %\\ \hline
    &  \multicolumn{3}{c}{AW} \vline  & \multicolumn{6}{c}{TWA-$sl$} \\ \hline
$ G$ & $ L$ & $W$ & $ S  $ & $ L$ & $W$ & $ S $ & $ t $ & $Cap$ & $ I $\\ \hline
$ 1 $ & $ 1$ & $1$ & $ 09 $ & $ 1$ & $1$ & $ 06*$ & $00$ & $ 08$ & $ 0 $\\
$ 2 $ & $ 2$ & $2$ & $ 18 $ & $ 1$ & $1$ & $ 11*$ & $03$ & $ 03$ & $ 0 $\\
$ 3 $ & $ 2$ & $2$ & $ 32 $ & $ 1$ & $1$ & $ 14*$ & $00$ & $ 02$ & $ 0 $\\
$ 4 $ & $ 3$ & $3$ & $ 41 $ & $ 2$ & $2$ & $ 25*$ & $10$ & $ 01$ & $ 2 $\\
$ 5 $ & $ 4$ & $5$ & $ 50 $ & $ 3$ & $3$ & $ 46*$ & $00$ & $ 01$ & $ 2 $\\ \hline \hline
\end{tabular}

\caption{Resultados para a rede de $6$ nós. * Solução Ótima.}

\label{N6}
\end{center}
\end{table}


A oitava coluna da Tabela \ref{N6} traz o tempo, em segundos, que o SCIP levou para encontrar a primeira solução viável ($t$). Um fato 
importante é que, em todas as instâncias desta bateria de testes, este tempo foi suficiente para determinar a otimalidade da solução viável 
encontrada. Ou seja, também foi garantida a otimalidade para $S$. Essa possibilidade, além do interesse teórico, evidência a eficiência do método aqui
proposto. Como base de comparação, temos que em \cite{Karcius04} não é garantida a otimalidade para as métricas de interesse.

Ainda na Tabela \ref{N6}, na nona coluna está a capacidade das ligações lógicas ($Cap$) e por fim, na última coluna temos o histórico das tentativas 
com instância insolúvel. Nesta coluna, um $0$ (zero) significa que os resultados registrados nesta linha foram conseguidos na primeira execução do SCIP.
Analogamente, um número diferente de zero significa a quantidade de vezes em que foram encontradas instâncias insolúveis, antes da execução que proveu o
resultado expresso nesta linha. 

\begin{figure}[hb]
 \centering
 \includegraphics[bb=0 0 221 222, scale=1.4]{figs/Karcius-rede12.eps}
 % Karcius-rede6.eps: 0x0 pixel, 300dpi, 0.00x0.00 cm, bb=134 613 266 697
 \caption{Topologia Física da rede de 12 nós \cite{Karcius04}}
 \label{fig:Karcius-rede12}
\end{figure}

\begin{figure}[hb]
 \centering
 \includegraphics[bb=0 0 410 144, scale=1.0]{figs/Karcius-rede12-demandas.eps}
 % Karcius-rede12-demandas.eps: 0x0 pixel, 300dpi, 0.00x0.00 cm, bb=96 243 508 387
 \caption{Matriz de demandas para a rede de 12 nós.}
 \label{fig:Karcius-rede12-demandas}
\end{figure}


%  \clearpage
\begin{table}[!ht]
\begin{center}

\begin{tabular}{c|ccc|ccc|ccc} %\\ \hline
    &  \multicolumn{3}{c}{AW} \vline& \multicolumn{6}{c}{TWA-$sl$} \\ \hline
$ G$ & $ L$ & $W$ & $  S  $ & $ L$ & $W$ & $  S        $ & $ t  $ & $Cap$ & $ I $\\ \hline
$ 1 $ & $ 1$ & $1$ & $ 032 $ & $ 1$ & $1$ & $ 013*      $ & $016 $ & $ 35$ & $ 0 $\\
$ 2 $ & $ 2$ & $2$ & $ 052 $ & $ 1$ & $1$ & $ 027\,\,\, $ & $031 $ & $ 10$ & $ 0 $\\
$ 3 $ & $ 3$ & $3$ & $ 078 $ & $ 2$ & $2$ & $ 066\,\,\, $ & $176 $ & $ 04$ & $ 2 $\\
$ 4 $ & $ 4$ & $4$ & $ 104 $ & $ 2$ & $2$ & $ 074\,\,\, $ & $070 $ & $ 03$ & $ 0 $\\
$ 5 $ & $ 4$ & $4$ & $ 130 $ & $ 3$ & $3$ & $ 108\,\,\, $ & $133 $ & $ 02$ & $ 2 $\\
$ 6 $ & $ 5$ & $5$ & $ 147 $ & $ 3$ & $3$ & $ 091\,\,\, $ & $003 $ & $ 02$ & $ 0 $\\ \hline \hline
\end{tabular}

\caption{Resultados para a rede de $12$ nós. *: Solução Ótima.}

\label{N12}
\end{center}
\end{table}

Com o mesmo arranjo de colunas descrito acima, a Tabela \ref{N12} reúne os resultados para a rede de $12$ nós. Na Figura \ref{fig:Karcius-rede12} está
representada
a topologia física da rede de $6$ nós, e na Figura \ref{fig:Karcius-rede12-demandas} sua matriz de demandas de tráfego \cite{Karcius04}. Desta vez temos $6$
instâncias, do grau lógico $1$ até o $6$. Aqui também foram obtidos melhores resultados para o trio $L$, $W$ e $S$. Nesta etapa, os resultados de \cite{Karcius04}
foram obtidos com $6$ horas de execução, enquanto os resultados com o modelo TWA levaram $7.2$ minutos para serem produzidos. 

Mesmo quando não foi encontrado o valor ótimo para  $S$, através do método utilizado, a otimalidade está garantida para os parâmetros $L$
e $W$. Em particular, note que apenas a variação de $W$ influenciou nos resultados, pois $L$ sempre teve de ser fixado no seu valor máximo ($L =
W$).
Um detalhe importante é que, para a primeira instância da rede de $12$ nós ($G=1$), o SCIP também foi capaz de provar a otimalidade
para a primeira solução viável. Isto demonstra que o modelo TWA mantém desempenho
aceit\'avel mesmo com uma rede de maior porte. Com esses resultados mostramos
a viabilidade do procedimento de solução conjunta dos problemas VTD e RWA, que é totalmente baseada no modelo apresentado neste trabalho. 

\section{O Modelo KS}

Para os resultados publicados em \cite{Sivarajan01}, é feita uma modelagem MILP que minimiza congestionamento em redes sem conversores de comprimentos de
onda. Segundo os autores, esta formulação não é computacionalmente tratável, o que justificou a proposição dos métodos heurísticos descritos mais adiante
nesta seção. 

Reproduzimos nesta seção a formulação matemática encontrada em \cite{Sivarajan01}, a qual denominamos KS. Este é um modelo de programação linear inteira
mista, que combina variáveis reais e variáveis discretas. Ela modela os quatro subproblemas do projeto de uma
WRON. Mas topologia física é considerada conhecida, sendo passado como parâmetro para o modelo. Adotaremos aqui o índice $r$ tal como foi definido na Notação
\ref{indice:r}.

\begin{var}
 Ligação lógica, $b_{ijr}=1$ se existe a ligação lógica de índice $r$ entre o par $(i,j)$, ou $b_{ijr}=0$ caso contrário.
\end{var}

\begin{var}
 Alocação de comprimento de onda, $C_{ij}^{wr}=1$ se a ligação lógica de índice $r$ entre o par $(i,j)$ usa o comprimento de onda $w$, ou $C_{ij}^{wr}=1$ caso
contrário.
\end{var}

\begin{var}
 Rota física, $C_{mnij}^{wr}=1$ se a ligação lógica de índice $r$ entre o par $(i,j)$ usa o comprimento de onda $w$, passando pela ligação física $(m,n)$,
ou $C_{ij}^{wr}=1$ caso contrário.
\end{var}

\begin{var}
 $\lambda_{ijr}^{sd}\in \mathbb{R^+}$, Componente de Tráfego, representa a quantidade de tráfego fluindo
de uma fonte $s$ para um destino $d$, e passando pela ligação lógica entre o par $(i,j)$ de índice $r$.
\end{var}

\begin{var}
 $\lambda_{ijr}$, Tráfego total na ligação lógica entre o par $(i,j)$ de índice $r$.
\end{var}

\begin{var}
 $\lambda_{max} \in \mathbb{R^+}$, Congestionamento da rede.
\end{var}

\begin{equation}
 \text{Minimize: } \lambda_{max}
\end{equation}

\begin{equation}
\sum_{jr}  b_{ijr}  \leqslant GLout_i \Forall{i}
\end{equation}

\begin{equation}
\sum_{ir}  b_{ijr}  \leqslant GLin_j \Forall{j}
\end{equation}

\begin{equation}
 \sum_w C_{ij}^{wr} = b_{ijr} \Forall{(i,j,r)}
\end{equation}

\begin{equation}
 C_{mnij}^{wr} \leqslant C_{ij}^{wr} \Forall{(i,j,w,r,m,n)}
\end{equation}

\begin{equation}
 \sum_{ijr} C_{mnij}^{wr} \leqslant 1 \Forall{(w,m,n)}
\end{equation}

\begin{equation}
 \forall \,  \mbox{\small$(i,j,r,n)$}, \quad \sum_{mw} C_{mnij}^{wr}\cdot D_{mn} - \sum_{mw} C_{nmij}^{wr}\cdot D_{nm} = 
  \left\{\begin{aligned} b_{ijr}, & \quad n=j\\
								-b_{ijr}, & \quad n=i\\
								0, & \quad \text{caso contrário} \end{aligned}\right.
\end{equation}

\begin{equation}
 \lambda_{ijr}^{sd}  \leqslant b_{ijr}\cdot P_{sd} \Forall{(i,j,r,s,d)}
\end{equation}

\begin{equation}
 \lambda_{ijr} = \sum_{sd} \lambda_{ijr}^{sd} \Forall{(i,j,r)}
\end{equation}

\begin{equation}
 \lambda_{ijr} \leqslant \lambda_{max} \Forall{(i,j,r)}
\end{equation}

\begin{equation}
 \forall \,  \mbox{\small$(i,s,d)$}, \quad \sum_{jr} \lambda_{ijr}^{sd} - \sum_{jr} \lambda_{jir}^{sd} = \left\{\begin{aligned} P_{sd}, & \quad s=i\\
																										  -P_{sd}, & \quad d=i\\
																										  0, & \quad \text{caso contrário} \end{aligned}\right.
\end{equation}

Supondo grau lógico uniforme para toda a rede ($G$), o número de variáveis binárias deste modelo é da ordem de $\Theta(N^4\cdot W\cdot G)$.

O Modelo MILP é
relaxado e executado interativamente por $25$ vezes usando um plano de corte. As variáveis que representam a topologia lógica e os percursos físicos são
arredondadas, enquanto uma heurística de alocação de comprimentos de onda é aplicada para atribuir comprimentos de onda individualmente aos caminhos
ópticos. O tráfego é roteado pela topologia lógica utilizando uma formulação linear (LP) consistindo somente das restrições de tráfego do MILP relaxado. 

Supondo que existam $W$ comprimentos de onda disponíveis em cada ligação física, o MILP relaxado obtém uma solução que
satisfaz esta restrição. Mas, o algoritmo de alocação de comprimentos de onda, que é aplicado subsequentemente, 

não dá garantia de que haja a solução
válida gerada para o problema de alocação de comprimentos de onda. No caso, as soluções válidas deveriam respeitar o limite de $W$ comprimentos de onda, que
foi imposto à solução do MILP relaxado.

, respeitando o limite de $W$ comprimentos de
onda. Como resultado, o método não retorna necessariamente soluções viáveis para todos os casos. Sendo esta uma das desvantagens desse método.


\section{Comparação com o modelo KS}
\label{cap:testes-sec:sivarajan}

 Nos resultados que iremos confrontar, é considerado o grau lógico da rede ($G$), não há multiplicidade de ligações lógicas e a função objetivo é o
congestionamento. Para produzir resultados passíveis de comparação, são acrescentadas à modelagem básica do TWA, mostrada na Seção \ref{Basic}: as Restrições
\ref{ConservGl} de controle do grau lógico; a Restrição \ref{cases:rest:Ml} de controle de multiplicidade de ligações lógicas, com $M=1$; e a Restrição
\ref{Hmax} que determina o congestionamento como função objetivo. Esta formulação específica é denominada de
TWA$c_1$.
 
\begin{figure}[htb]
 \centering
 \includegraphics[bb=115 313 518 540, scale=1.12]{figs/nsfnet_14nodes.eps}
 % nsfnet.eps: 0x0 pixel, 300dpi, 0.00x0.00 cm, bb=115 313 518 540
 \caption{Rede de 14 nós NSFNET \cite{Sivarajan01}.}
 \label{fig:nsfnet}
\end{figure}

\begin{table}[htb]
 \centering
\caption{Matriz de demandas $P1$ \cite{ram96}.}
\tiny
% \small
\begin{tabular}{llllllllllllll} \hline
	0.000 & 33.029 & 32.103 & 26.008 & 0.525 & 0.383 & 82.633 & 31.992 & 37.147 & 0.568 & 0.358 & 0.544 & 0.651 & 0.160\\
	0.546 & 0.000 & 0.984 & 0.902 & 0.866 & 0.840 & 0.013 & 62.464 & 0.475 & 0.001 & 0.342 & 0.925 & 0.656 & 0.501\\
	35.377 & 0.459 & 0.000 & 0.732 & 0.272 & 0.413 & 28.242 & 0.648 & 0.909 & 0.991 & 56.150 & 23.617 & 1.584 & 0.935\\
	0.739 & 0.225 & 0.296 & 0.000 & 0.896 & 0.344 & 0.012 & 84.644 & 0.293 & 0.208 & 0.755 & 0.106 & 0.902 & 0.715\\
	0.482 & 96.806 & 0.672 & 51.204 & 0.000 & 0.451 & 0.979 & 0.814 & 0.225 & 0.694 & 0.504 & 0.704 & 0.431 & 0.333\\
	0.456 & 0.707 & 0.626 & 0.152 & 0.109 & 0.000 & 0.804 & 0.476 & 0.429 & 0.853 & 0.280 & 0.322 & 90.503 & 0.212\\
	0.042 & 0.067 & 0.683 & 0.862 & 0.197 & 0.831 & 0.000 & 0.585 & 67.649 & 56.138 & 0.896 & 0.858 & 73.721 & 0.582\\
	0.616 & 0.640 & 0.096 & 97.431 & 0.308 & 0.441 & 0.299 & 0.000 & 0.161 & 0.490 & 0.321 & 0.638 & 82.231 & 0.376\\
	0.786 & 0.323 & 0.676 & 0.359 & 0.019 & 50.127 & 12.129 & 0.650 & 0.000 & 0.483 & 45.223 & 58.164 & 0.894 & 0.613\\
	0.037 & 0.318 & 0.367 & 2.981 & 0.976 & 0.629 & 0.525 & 0.293 & 0.641 & 0.000 & 33.922 & 0.228 & 0.995 & 71.905\\
	12.609 & 0.479 & 0.146 & 0.174 & 0.181 & 0.072 & 23.080 & 0.671 & 0.634 & 0.759 & 0.000 & 0.725 & 0.592 & 0.445\\
	0.887 & 0.004 & 1.614 & 0.471 & 0.120 & 0.263 & 0.585 & 0.086 & 0.157 & 95.633 & 42.828 & 0.000 & 0.527 & 0.021\\
	9.019 & 0.569 & 0.936 & 0.975 & 81.779 & 0.573 & 0.738 & 0.410 & 0.490 & 0.948 & 0.154 & 0.145 & 0.000 & 0.436\\
	20.442 & 0.515 & 0.719 & 0.089 & 39.269 & 49.984 & 0.720 & 0.863 & 0.858 & 0.490 & 0.106 & 0.765 & 0.059 & 0.000\\
\end{tabular}
\label{tab:p1-demandas}
\end{table}

\begin{table}[htb]
\caption{Matriz de demandas $P2$ \cite{ram96}.}
 \centering
\tiny
% \small
\begin{tabular}{llllllllllllll} \hline
0.000 & 1.090 & 2.060 & 0.140 & 0.450 & 0.040 & 0.430 & 1.450 & 0.510 & 0.100 & 0.070 & 0.080 & 0.000 & 0.330\\
11.710 & 0.000 & 8.560 & 0.620 & 11.120 & 7.770 & 3.620 & 15.790 & 3.660 & 16.610 & 2.030 & 37.810 & 4.830 & 13.190\\
0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000\\
0.310 & 3.410 & 13.64 & 0.000 & 1.900 & 0.600 & 0.700 & 2.880 & 2.000 & 3.260 & 3.070 & 6.690 & 0.080 & 4.010\\
0.280 & 67.510 & 19.02 & 3.430 & 0.000 & 4.030 & 10.77 & 62.22 & 24.02 & 17.92 & 0.450 & 79.03 & 9.970 & 5.290\\
0.000 & 5.810 & 3.420 & 5.520 & 3.400 & 0.000 & 2.610 & 2.680 & 0.870 & 3.870 & 0.040 & 0.840 & 0.060 & 2.480\\
1.750 & 22.02 & 102.31 & 4.470 & 22.03 & 7.900 & 0.000 & 114.1 & 19.82 & 21.95 & 0.780 & 71.40 & 0.330 & 32.84\\
2.390 & 63.84 & 210.30 & 8.520 & 28.210 & 2.660 & 97.08 & 0.000 & 43.95 & 33.00 & 11.37 & 48.63 & 5.530 & 13.85\\
6.450 & 18.93 & 37.35 & 6.000 & 24.99 & 6.810 & 25.06 & 61.02 & 0.000 & 39.62 & 14.52 & 127.5 & 23.34 & 0.760\\
0.050 & 35.29 & 10.26 & 3.730 & 22.34 & 9.480 & 4.980 & 57.08 & 6.840 & 0.000 & 6.300 & 17.64 & 5.910 & 0.760\\
0.100 & 1.020 & 3.130 & 1.690 & 0.240 & 0.060 & 0.810 & 1.450 & 0.580 & 7.120 & 0.000 & 0.840 & 0.060 & 0.500\\
1.280 & 26.15 & 1.000 & 5.940 & 24.86 & 1.320 & 5.490 & 40.57 & 29.53 & 22.37 & 10.50 & 0.000 & 1.010 & 0.540\\
0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000 & 0.000\\
0.730 & 29.09 & 13.63 & 9.890 & 35.61 & 12.07 & 6.440 & 28.79 & 4.670 & 0.000 & 3.990 & 0.000 & 10.750 & 0.000\\
\end{tabular}
\label{tab:p2-demandas}
\end{table}


\begin{table}[htb]
\caption{Matriz de distâncias para a NSFNET, em centenas de milhas.}
 \centering
% \tiny
\begin{tabular}{llllllllllllll} \hline
0	&	7	&	10	&	7	&	10	&	19	&	13	&	16	&	21	&	21	&	19	&	22	&	24	&	22\\
7	&	0	&	4	&	5	&	9	&	16	&	14	&	18	&	22	&	21	&	20	&	24	&	25	&	21\\
10	&	4	&	0	&	6	&	8	&	12	&	13	&	17	&	21	&	19	&	19	&	23	&	24	&	19\\
7	&	5	&	6	&	0	&	4	&	12	&	8	&	12	&	17	&	16	&	13	&	18	&	19	&	16\\
10	&	9	&	8	&	4	&	0	&	8	&	4	&	9	&	13	&	12	&	11	&	15	&	16	&	12\\
19	&	16	&	12	&	12	&	8	&	0	&	8	&	8	&	11	&	7	&	11	&	14	&	14	&	12\\
13	&	14	&	13	&	8	&	4	&	8	&	0	&	5	&	9	&	8	&	7	&	10	&	11	&	8\\
16	&	18	&	17	&	12	&	9	&	8	&	5	&	0	&	5	&	5	&	3	&	6	&	7	&	5\\
21	&	22	&	21	&	17	&	13	&	11	&	9	&	5	&	0	&	5	&	2	&	2	&	2	&	5\\
21	&	21	&	19	&	16	&	12	&	7	&	8	&	5	&	5	&	0	&	6	&	7	&	7	&	6\\
19	&	20	&	19	&	13	&	11	&	11	&	7	&	3	&	2	&	6	&	0	&	4	&	5	&	6\\
22	&	24	&	23	&	18	&	15	&	14	&	10	&	6	&	2	&	7	&	4	&	0	&	2	&	5\\
24	&	25	&	24	&	19	&	16	&	14	&	11	&	7	&	2	&	7	&	5	&	2	&	0	&	1\\
22	&	21	&	19	&	16	&	12	&	12	&	8	&	5	&	5	&	6	&	6	&	5	&	1	&	0\\
\end{tabular}
\label{tab:distancias-NSFNET}
\end{table}

Na Figura \ref{fig:nsfnet} está representada a topologia física da rede NSFNET, na qual são baseados os testes em \cite{Sivarajan01}. Nas Tabelas
\ref{tab:p1-demandas} e \ref{tab:p2-demandas}, respectivamente, estão as matrizes de demandas $P1$ e $P2$ da NSFNET \cite{ram02}. Já na Tabela
\ref{tab:distancias-NSFNET} estão as distâncias entre os nós da topologia física da NSFNET adotada, em centenas de milhas.

Nas Tabelas \ref{p1} e \ref{p2} são confrontados os resultados obtidos com o TWA$c_1$ e os encontrados em \cite{Sivarajan01}, com o modelo KS. Para cada grau
lógico, são exibidos: na coluna MILP, o valor de congestionamento obtido executando o modelo MILP do TWA$c_1$ com o SCIP; na coluna $T$, o tempo gasto
pelo SCIP para chegar a essa solução; na coluna $W$, o número de comprimentos de onda utilizados pelo TWA$c_1$; e na coluna MTB, o \textit{Minimum Trafic Bound}
para cada instância. Também são exibidos, para o modelo KS, na coluna $UB$, as melhores soluções para o congestionamento encontradas em  \cite{Sivarajan01}, e nas
colunas $LB$ e $W$, os respectivos \textit{lower bounds} e  número de comprimentos de onda utilizados pelo KS. Quando o valor de congestionamento corresponde ao
ótimo da instância, ele é marcado com um asterisco.

Nos resultados para a modelagem KS, para cada instância, o
cálculo do LB levou em média 125 minutos utilizando o método iterativo encontrado em \cite{ram02}. O \textit{upper bound} (UB) foi obtido por meio de uma
heurística, levando menos de um minuto. Portanto, a otimalidade só pôde ser garantida nesses resultados quando o valor viável encontrado era igual ao
\textit{lower bound} obtido. Esses resultados foram produzidos com a \textit{IBM's Optimization Subroutine Library (OSL)} em um computador IBM 43P/RS6000.

\begin{table}
% [!ht]
\begin{center}
\caption{Legendas para as Tabelas \ref{p1} e \ref{p2}.}

\begin{tabular}{|r|l|} \hline
Sigla  & Significado\\ \hline
$G$  & Grau Lógico\\
$W$   & Número de comprimentos de onda disponíveis\\
MTB  & \textit{Minimum Trafic Bound}\\
MILP & Resultados obtidos pelo SCIP\\
$T$   & Tempo em minutos gasto com o SCIP\\
KS & Melhores resultados com o modelo KS\\
$LB$   & Lower Bound para o congestionamento\\
$UB$   & Uper Bound para o congestionamento\\ \hline
\end{tabular}
\label{tab:legendas-Sivarajan}
 \end{center}
\end{table}

\begin{table}
% [!ht]
 \begin{center}
\caption{Resultados para a matriz $P1$. *: Ótimo alcançado.}
\begin{tabular}{|c|crrr|rrc|}
\hline $P1$ &    \multicolumn{4}{|c|}{TWA$c_1$}     & \multicolumn{3}{c|}{KS}   \\ \hline \hline
		  $G$ & $W$ & $T_{(m)}$ &   MTB    &   MILP   & $LB$     & $UB$     & $W$ \\ \hline
		  $ 2$ & $2$ & $451$     & $126.87$ & $143.66$ & $126.74$ & $145.74$ & $4$ \\ \hline
		  $ 3$ & $3$ & $221$     & $ 84.58$ & $^*84.58$& $84.58$  & $^*84.58$& $4$ \\ \hline
		  $ 4$ & $3$ & $8$       & $ 63.44$ & $69.17$  & $63.43$  & $70.02$  & $4$ \\ \hline
		  $ 5$ & $4$ & $225$     & $ 50.75$ & $50.82$  & $50.74$  & $50.94$  & $5$ \\ \hline
		  $ 6$ & $4$ & $24$      & $ 42.29$ & $43.54$  & $42.29$  & $44.39$  & $6$ \\ \hline
		  $ 7$ & $5$ & $65$      & $ 36.25$ & $^*36.25$& $36.25$  & $36.43$  & $6$ \\ \hline
		  $ 8$ & $6$ & $102$     & $ 31.72$ & $^*31.72$& $31.72$  & $31.77$  & $7$ \\ \hline
		  $ 9$ & $7$ & $131$     & $ 28.19$ & $^*28.19$& $28.19$  & $28.37$  & $9$ \\ \hline
		  $10$ & $8$ & $72$      & $ 25.37$ & $25.53$  & $25.37$  & $25.64$  & $9$ \\ \hline
		  $11$ & $9$ & $200$     & $ 23.07$ & $23.31$  & $23.00$  & $23.08$  & $11$\\ \hline
		  $12$ & $11$& $140$     & $ 21.14$ & $21.35$  & $21.27$  & $21.39$  & $12$\\ \hline
		  $13$ & $13$& $16$      & $ 19.52$ & $^*20.25$& $20.24$  & $20.25$  & $13$\\ \hline
\end{tabular}                                               
\label{p1}                                                  
 \end{center}                                              
\end{table}                                                 
                                                                                                                                                                  
                                                                                                                                                                  
                                                                                                                                                        
% \newpage
\begin{table}
% [!ht]
 \begin{center}
\caption{Resultados para a matriz $P2$. *: Ótimo alcançado.}
\begin{tabular}{|c|crrr|rrc|}
\hline $P2$ &    \multicolumn{4}{|c|}{TWA$c_1$}     & \multicolumn{3}{c|}{KS}       \\ \hline \hline
		  $G$ & $W$ & $T_{(m)}$ &   MTB    &    MILP    & $LB$     & $UB$      & $W$  \\ \hline
		  $ 2$ & $1$ & $152$     & $284.66$ & $^*292.31$ & $284.26$ & $389.93$  & $2$  \\ \hline
		  $ 3$ & $2$ & $4.4$     & $189.78$ & $^*189.78$ & $189.76$ & $217.80$  & $4$  \\ \hline
		  $ 4$ & $2$ & $2$       & $142.33$ & $^*142.33$ & $142.33$ & $152.99$  & $3$  \\ \hline
		  $ 5$ & $3$ & $4$       & $113.87$ & $^*113.87$ & $113.87$ & $^*113.87$& $4$  \\ \hline
		  $ 6$ & $3$ & $3.9$     & $94.89$  & $^*94.89$  & $94.89$  & $^*94.89$ & $5$  \\ \hline
		  $ 7$ & $4$ & $4.3$     & $81.33$  & $^*81.33$  & $81.33$  & $^*81.33$ & $6$  \\ \hline
		  $ 8$ & $4$ & $6.8$     & $71.17$  & $^*71.17$  & $71.17$  & $^*71.17$ & $6$  \\ \hline
		  $ 9$ & $5$ & $20.9$    & $63.26$  & $^*63.26$  & $62.15$  & $63.26$   & $9$  \\ \hline
		  $10$ & $6$ & $20.1$    & $56.93$  & $^*56.93$  & $56.93$  & $^*56.93$ & $10$ \\ \hline
		  $11$ & $6$ & $23.2$    & $51.75$  & $^*51.75$  & $51.75$  & $^*51.75$ & $10$ \\ \hline
		  $12$ & $7$ & $23.1$    & $47.44$  & $^*47.44$  & $47.44$  & $^*47.44$ & $13$ \\ \hline
		  $13$ & $7$ & $14.8$    & $43.79$  & $^*43.79$  & $43.79$  & $^*43.79$ & $13$ \\ \hline
\end{tabular}
\label{p2}
 \end{center}
\end{table}
% \clearpage

Para ambas as matrizes, foram obtidos melhores resultados com o TWA$c_1$, em comparação com os resultados para o modelo KS, tanto para o valor de
congestionamento quanto para o número de comprimentos de onda utilizados. Outro fato importante é qualidade alcançada pelo MTB em todas as instâncias,
praticamente igual ao \textit{lower bound} obtido em \cite{Sivarajan01}, mas com demanda de tempo desprezível. Esse é um resultado expressivo, frente aos $125$
minutos, em média, gastos com o método iterativo \cite{ram02}. Em $62\%$ das instâncias, o MTB equivale ao ótimo. E mesmo quando o ótimo diferiu do MTB, no pior
caso, o MTB ficou menos de $5\%$ abaixo do ótimo. Por fim vale ressaltar que foram obtidas soluções ótimas para $70\%$ das instâncias com o TWA$c_1$,
contra $37\%$ dos resultados para o modelo KS. 

O tempo demandado pelo SCIP para obter os resultados aqui apresentados são altos, se comparados ao desempenho de heurísticas para o congestionamento no projeto
encontradas na literatura \cite{Sivarajan01,Nina05}. Todavia, esses resultados corroboram para eficiência do modelo TWA. Pois, seu reduzido número de variáveis e
equações, possibilitou obter tais soluções sem que para isso fosse necessário recorrer à heurísticas. 













