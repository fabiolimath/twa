
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Lower Bounds
%% Copyright 2009 Fabio de Oliveira Lima.
%% Este documento é distribuído nos termos da licença 
%% GNU General Public License v2.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\chapter{Limitantes Inferiores}
\label{lb}


Nos trabalhos encontrados na literatura, no que diz respeito ao congestionamento, encontrar boas soluções é uma tarefa fácil para
heurísticas \cite{Sivarajan01,Nina05}. Todavia, o cálculo de limitantes inferiores (\textit{lower bounds} - LB) que garantam essa qualidade tem elevado
custo computacional, sendo esta
a parte mais difícil dessa abordagem. Apresentamos na seção a seguir uma nova técnica para a obtenção de \textit{lower bounds} para o congestionamento. Ela
é uma formula de cálculo direto, que denominamos \textit{Minimum Traffic Bound} (MTB), fornecendo um LB de alta qualidade para o
congestionamento, com custo computacional muito pequeno, cuja eficiência contrasta com as opções encontradas na literatura \cite{ram96}. 

\section{MTB - Limitante Inferior para o Congestionamento}

Para determinar um LB para o congestionamento, precisamos estimar qual é o mínimo de tráfego que pode ser designado a cada ligação lógica da rede. Não há
uma
resposta direta, mas podemos fazer uma estimativa olhando cada nó independentemente. 
Na melhor das hipóteses, todo o tráfego que passa pelas ligações lógicas
iniciadas em um nó $v$ é composto exclusivamente por demandas de tráfego também originadas neste mesmo nó. Analogamente, o tráfego nas ligações lógicas
incidentes em $v$ seria
composto por demandas destinadas a ele. Esses são os menores valores possíveis, considerando que todo o tráfego da rede será devidamente enviado e recebido.

Assim,  dividindo todo o tráfego originado em $v$ pelo número de ligações lógicas nele iniciadas,
temos uma estimativa do menor tráfego possível nessas ligações lógicas. Analogamente, uma estimativa pode ser feita para o tráfego destinado a $v$ nas
ligações lógicas nele incidentes. Extrapolando isso para toda a rede, a maior dentre essas estimativas seria uma boa
candidata a limitante inferior para o congestionamento. Isto porque não é possível que um nó envie menos tráfego do que a soma das demandas originadas
nele. E analogamente, não é possível que um nó receba menos tráfego do que o destinado a ele. O MTB é assim definido como o mínimo dos valores calculados
nas equações do conjunto de Dados \ref{MT}. 

Para estabelecer o MTB, consideraremos apenas o número de ligações lógicas iniciando ou terminando em cada nó da rede. Nas modelagens para o VTD, essa é toda a
informação disponível sobre a topologia lógica da rede. Mas em modelagens mais abrangentes, como o TWA, isso pode não
ser um dado de entrada.

% {\small
\begin{dados}
Sejam $\alpha_v$ o número de ligações lógicas originadas em um nó $v$ e $\beta_v$ o número de ligações lógicas incidentes em $v$.
Deste modo:
\begin{enumerate}
\item $\Theta_v = \displaystyle\sum_d P_{vd}/\alpha_v\quad$ 
\item $\Gamma_v = \displaystyle\sum_s P_{sv}/\beta_v$ 
% \item $\Omega_{v_1v_2} = \max\{\Theta_{v_1},\Gamma_{v_2}\}$
\item $MTB = \max_{v_1v_2} \{\Theta_v,\Gamma_v\}$
\end{enumerate}
\label{MT}
\end{dados}

As estimativas comentadas acima, para o tráfego mínimo saindo e chegando em cada ligação lógica incidente ou originada em $v$, são $\Theta_v$ e $\Gamma_v$,
respectivamente. 
% Segue que, $\Omega_{v_1v_2}$ é a estimativa de tráfego mínimo nas ligações lógicas entre o par $(v_1,v_2)$, que equivale ao maior valor
% entre as estimativas de tráfego originado em $v_1$ ($\Theta_{v_1}$) e recebido em $v_2$ ($\Gamma_{v_2}$). 
Por sua vez, o MTB é definido como o máximo entre as
estimativas $\Theta_v$ e $\Gamma_v$. O teorema a seguir garante que o MTB é um LB para o congestionamento. Em sua demostração será necessária a proposição
abaixo.
% estimativas $\Omega_{v_1v_2}$. O teorema a seguir garante que o MTB é um LB para o congestionamento.

\begin{proposition}
   Para qualquer solução viável de uma instância do VTD, para cada nó $v_1$ da rede irá existir um nó $v_2$, tal que, há uma ligação lógica entre o par
$(v_1,v_2)$ na solução, e o tráfego nessa ligação é maior ou igual à $\Theta_{v_1}$. Analogamente, haverá uma ligação entre $(v_3,v_1)$, para algum nó
$v_3$, tal que, o tráfego nessa ligação é maior ou igual à $\Gamma_{v_1}$ 
\end{proposition}

\begin{proof}

Seja $\Phi_{v_1v_2}$ o tráfego em uma ligação lógica $(v_1,v_2)$. É necessário demostrar que, em uma solução viável qualquer:

\begin{equation}
(\forall\, v_1) \,(\exists\,v_2) \mbox{, tal que, }\Phi_{v_1v_2} \geqslant \Theta_{v_1}  
\label{lb:p1}
\end{equation} 

\begin{equation}
(\forall\, v_1) \,(\exists\,v_3) \mbox{, tal que, }\Phi_{v_3v_1} \geqslant \Gamma_{v_1}  
\label{lb:p2}
\end{equation} 

Será provado a seguir que a afirmação em \ref{lb:p1} é verdadeira.

Seja $\Psi_{v}$ a soma de todo o tráfego nas ligações lógicas iniciadas em $v$, em uma solução viável qualquer. O mínimo tráfego que $v$ pode originar,
considerando todas as ligações lógicas iniciadas nele, é composto pelas demandas de tráfego com origem em $v$, ou seja, $\sum_d P_{vd}$.  Considerando que
algum tráfego possa ser retransmitido através de $v$, apos ser processado eletronicamente, conclui-se que:

\begin{equation}
\Psi_{v} \geqslant \sum_d P_{vd}
\label{lb:traf}
\end{equation} 

Seja $\overline{\Psi}_{v}$ o tráfego médio das ligações lógicas iniciadas em $v$, em uma solução viável qualquer. Dividindo os dois lados da inequação em
\ref{lb:traf} por $\alpha_{v}$, segue que: 

\begin{equation}
\frac{1}{\alpha_v}\cdot\left(\Psi_v \geqslant \sum_d P_{vd} \right) \quad \Longrightarrow  \quad
\frac{\Psi_v}{\alpha_v} \geqslant \frac{\sum_d P_{vd}}{\alpha_v} \quad \Longrightarrow \quad
\overline{\Psi}_v \geqslant \Theta_v
\label{lb:med}
\end{equation} 
% \overline{\Psi}_{v} = \frac{\Psi_{v}}{\alpha_{v}} \geqslant \frac{\sum_d P_{{v}d}}{\alpha_{v}} = \Theta_{v}

% Portanto, $\overline{\Psi}_v \geqslant \Theta_v$; o tráfego médio saindo de $v$ é maior ou igual à $\Theta_{v}$.

Como foi provado em \ref{lb:med}, para todo nó
$v_1$, $\overline{\Psi}_{v_1}\geqslant \Theta_{v_1}$, em uma solução viável qualquer. Assim, em alguma
ligação lógica iniciada em $v_1$, o tráfego é maior ou igual à $\Theta_{v_1}$, ou seja, provou-se que \ref{lb:p1} é válida. A demostração para \ref{lb:p2} é
análoga e será omitida.

\end{proof}


\begin{theorem}[\textit{Minimum Traffic Bound} -- MTB]
\label{MTB} 
Dado o número de ligações lógicas originadas e incidentes em cada nó da rede, o MTB definido no conjunto de
Dados \ref{MT} é um limitante inferior para o congestionamento.
\end{theorem}

\begin{proof}
% Seja $(\zeta,\gamma)$ uma ligação lógica, parte de uma solução ótima para o VTD, cujo tráfego corresponde ao valor ótimo do congestionamento $\lambda_max*$.
% $$\Omega_{v_1v_2} \leqslant \lambda_{max}^* \Forall{(v_1,v_2)}$$  
% Para que isso seja válido, é suficiente que sejam verdadeiras as inequações a seguir:

Seja $\lambda_{max}^*$ o valor ótimo do congestionamento. Para demostrar a validade do teorema, devemos demostrar que $MTB \leqslant \lambda_{max}^*$, o que
equivale a mostrar que sejam verdadeiras as inequações a seguir:

\begin{equation}
\Theta_{v} \leqslant \lambda_{max}^*\Forall{v}
\label{lb:i}
\end{equation} 

\begin{equation}
\Gamma_{v} \leqslant \lambda_{max}^*\Forall{v}
\label{lb:ii}
\end{equation} 

Para demostrar que a inequação \ref{lb:i} é válida, suponha por absurdo que ela é falsa, ou seja: 

\begin{equation}
\exists\,v \mbox{, tal que, } \Theta_v > \lambda_{max}^*
\label{lb:ni}
\end{equation} 

Do que foi suposto em \ref{lb:ni}, mais da conclusão obtida em \ref{lb:p1}, se $\Theta_{v_1} > \lambda_{max}^*$, segue que $\Phi_{v_1v_2} > \lambda_{max}^*$
para qualquer solução viável. O que é absurdo para as soluções ótimas, pois
contraria a definição de $\lambda_{max}^*$, como o tráfego da ligação lógica mais carregada. Isso prova que a inequação \ref{lb:ni} é falsa, ou seja,
demonstra que \ref{lb:i} é verdadeira, como se queria. De modo análogo pode-se verificar a validade da inequação \ref{lb:ii}, que conclui a
demostração do teorema.
%\bsq
% O que conclui a demostração. 
\end{proof}

Note que não foi feita restrição quanto à multiplicidade de ligações lógicas, nem uniformidade do grau lógico. Estamos considerando portanto o caso mais
geral do VTD. 

Dizemos que o MTB é um LB para para o VTD, pois a única restrição feita é quanto ao conhecimento do número de ligações lógicas iniciando e terminando em cada nó.
Em modelagens mais abrangentes, como o TWA, a introdução de mais restrições e variáveis pode fazer com que o ótimo do VTD se torne inviável. Ainda assim, o MTB
será um LB para o congestionamento, todavia, outras técnicas de obtenção de LB poderiam ser empregadas para explorar o espaço do conjunto de soluções que se
tornou inviável. Uma alternativa é a conhecida técnica iterativa apresentada em \cite{ram02}.

O MTB foi aqui estabelecido em sua forma mais geral, considerando que cada nó pode possuir quantidades diferentes de ligações lógicas originadas ou incidentes,
entretanto, na literatura é comum considerar que os nós da rede possuem grau lógico uniforme \cite{ram02}. Neste caso, o MTB consiste no valor máximo do
do conjunto das somas das demandas originadas ou recebidas em cada nó, divido pelo grau lógico da rede.
Portanto, convém apresentar uma formulação mais direcionada para implementações. Isso é feito a seguir no Lema \ref{lem:MTB}.

\begin{lemma}
\label{lem:MTB}
 Se a rede possui grau lógico uniforme $GL$, o MTB pode ser definido da seguinte forma:
 $$ \mbox{MTB} = \frac{1}{GL}\cdot\max_v \left\{\sum_d P_{vd},\sum_s P_{sv}\right\}$$
\end{lemma}


Em última análise, o MTB explora a possibilidade da ligação lógica mais carregada da rede transportar predominantemente tráfego que não foi ou não será
retransmitido. De fato, se $(i,j)$ é a ligação mais carregada da rede, o ideal é que a maior parte de seu tráfego seja destinado ao nó onde onde esta
ligação lógica incide ($j$). Pois do contrário, muito tráfego seria retransmitido ao longo da rede, congestionando outras ligações. Isso leva a crer que o
nó $j$ pode ter muito tráfego a receber da rede. Por outro lado, quanto mais tráfego for originário de $i$, ouve menos retransmissão antes de chegar nele.

Tem-se ai duas tendências que podem dominar a ligação lógica $(i,j)$: $j$ é o destino principal na rede, ou $i$ é o principal gerador de tráfego. É
razoável que uma delas prevaleça. Por exemplo, se $j$ precisa receber mais tráfego do que $i$ origina, seria melhor $i$ escoar esse tráfego por
outra saída, que não $j$. Estendendo essa ideia a todo o projeto da topologia lógica é de esperar que, na solução ótima, grandes emissores de tráfego
tendem a não iniciar uma ligação lógica com destino a um grande receptor de tráfego. E mesmo quando isso ocorresse, seria razoável que as duas tendências
não concorressem numa mesma ligação lógica, mas sim, que a mais fraca tomasse caminhos alternativos. 

Deste modo, procurar por um LB se resumiria a encontrar a tendência mais forte, seja de emissão ou recepção. Essa é a ideia por trás do MTB, que apenas
investiga a matriz de demandas de tráfego atrás da maior tendência. Esta suposição revelou-se válida empiricamente, posto que na maioria dos testes feitos o
MTB equivale ao ótimo, como será visto no Capítulo \ref{cap:testes}. Por sorte, esse comportamento tem uma relação tão direta com o grau lógico de entrada e
saída dos nós. 

Mas há um ponto fraco nessa linha de pensamento. Ela depende que o tráfego na ligação lógica mais carregada seja predominantemente caracterizado por sua
tendência dominante. Isso tende a ser mais certo quanto mais assimétrica for matriz de demandas. Mas, se esta for fortemente uniforme, com pouca variação
entre o tamanho da demandas, a quantidade de tráfego a ser retransmitida na rede superará com facilidade as tendências individuas de cada nó. Portanto, é
esperado que a qualidade do LB fornecido pelo MTB seja melhor em cenários de tráfego assimétrico. Todavia, nos testes realizados no Capítulo
\ref{cap:testes}, mesmo para uma matriz com demandas uniformemente distribuídas, o MTB se mostrou bem eficiente.






% \subsection{Dichotomous Search Bound}
% 
% Uma forma de se obter \textit{lower bounds} para o congestionamento foi apresentada em \cite{ram02}. Esta técnica consiste
% na relaxação do modelo MILP, adicionando um \textit{lower} \textit{bound} conhecido $\lambda_{LB}$ à definição do congestionamento. O congestionamento
% $\lambda_{max}$ é a quantidade de tráfego transportada pelo enlace lógico mais solicitado $\lambda_{ij}$, ou seja, $\lambda_{max}\geq \lambda_{ij}$, $\forall
% i,j$. Se não há um caminho lógico entre os nós $i$ e $j$ ($b_{ij}=0$), então, $\lambda_{ij}=0$. Para obtenção de um novo LB para o congestionamento, é
% acrescentada a restrição $\lambda_{max}\geq (1-b_{ij})\lambda_{LB}$, que pode ficar como $\lambda_{max}\geq \lambda_{ij}+(1-b_{ij})\lambda_{LB}$, sem modificar
% o
% modelo MILP. Todavia, relaxando a variável binária $b_{ij}$, permitindo que ela varie entre zero e um, esta definição para o $\lambda_{max}$ pode fornecer um
% valor superior a $\lambda_{LB}$, ou no mínimo igual, mas, ainda sendo um LB para o congestionamento. 
% 
% Entretanto, é
% possível usar uma ``previsão' para se obter LBs, usando o método iterativo. Pois, no modelo relaxado do ILB, não é necessário se conhecer um LB para poder
% produzir outro superior. Se, ao invés de entrarmos com um LB conhecido ($\lambda_{LB}$) na definição do congestionamento ($\lambda_{max}$), usássemos um valor
% qualquer $V$. Teríamos a restrição: 
% 
% \begin{equation}
% \label{hmaxv}
% \lambda_{max}\geq \lambda_{ij}+(1-b_{ij})V
% \end{equation} 
% 
% Para este contexto, faremos a seguir algumas definições. Sejam:
% 
% \begin{itemize}
%  \item $\lambda_{max}(V)$, os $\lambda_{max}$ definidos em função deste $V$.
%  \item $W(V)=\min\{\lambda_{max}(V)\}$, o mínimo dentre os $\lambda_{max}$ no modelo MILP relaxado, definidos pelo conjunto de restrições na Equação \ref{hmaxv}
% acima. Ou seja, o ótimo na relaxação do ILB, mas com $V$ no lugar de $\lambda_{LB}$.
% \item $Z^*$, o ótimo do modelo MILP para uma dada instância.
% \end{itemize}
% 
% Segue que, se $V\geq Z^*$ então $W(V)\leq V$, pois, no modelo MILP, setando este $V$, o ótimo seria ele mesmo. Assim, na relaxação esta desigualdade é
% garantida.
% Pois, relaxando um modelo de minimização, abrimos a possibilidade de encontrar uma solução menor. Mas, um modo equivalente de se escrever esta desigualdade é:
% se
% $W(V) > V$ então $V<Z^*$. Ou seja, entrando com um valor qualquer no lugar do LB, no processo iterativo, se o resultado for maior que o valor passado, então ele
% era de fato um LB para aquela instância. 



